"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3560],{17485:function(e,n,a){a.d(n,{Z:function(){return o}});var t=a(35453),r=a(50959),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"},s=a(52273),i=function(e,n){return r.createElement(s.Z,(0,t.Z)({},e,{ref:n,icon:l}))};var o=r.forwardRef(i)},19748:function(e,n,a){var t=a(26068),r=a.n(t),l=a(31759),s=a.n(l),i=a(48305),o=a.n(i),u=a(16850),c=a(16333),d=a(90515),p=a(99178),m=a(1956),f=a(85885),v=a(32699),g=a.n(v),h=a(50959),x=a(11527),y="bash",b="python",j="javascript",w=[{label:"Curl",value:y},{label:"Python",value:b},{label:"Nodejs",value:j}],C=function(e){var n=e||{},a=n.title,t=n.open,l=n.api,i=n.clientType,v=n.logcommand,C=n.onCancel,k=n.payload,Z=n.parameters,z=void 0===Z?{}:Z,_=(0,p.useIntl)(),S=(0,h.useState)(y),N=o()(S,2),I=N[0],M=N[1],L="".concat(window.location.origin,"/v1-openai"),q=(0,h.useMemo)((function(){var e=v?"console.log(response.".concat(v,");\n"):"",n=v?"print(response.".concat(v,")"):"";if(I===y)return"curl ".concat(window.location.origin,"/v1-openai/").concat(l,' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(r()(r()({},z),k),null,2),"'");if(I===j)return'const OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(L,'"\n});\n\nasync function main(){\n  const params = ').concat(JSON.stringify(r()(r()({},z),k),null,4),";\nconst response = await openai.").concat(i,"(params);\n  ").concat(e,"}\nmain();");if(I===b){var a=g().keys(z).reduce((function(e,n){if(null===z[n])return e;var a="string"==typeof z[n]?'"'.concat(z[n],'"'):z[n];return e+"  ".concat(n,"=").concat(a,",\n")}),""),t=function(e){return g().keys(e).reduce((function(n,a){if(null===e[a])return n;var t="object"===s()(e[a])?JSON.stringify(e[a],null,2):'"'.concat(e[a],'"');return n+"  ".concat(a,"=").concat(t,",\n")}),"")}(k);return'from openai import OpenAI\n\nclient = OpenAI(\n  base_url="'.concat(L,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.').concat(i,"(\n").concat(a).concat(t,")\n").concat(n)}return""}),[I,k,z,l,i,v]);return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(m.Z,{title:a,open:t,centered:!0,onCancel:function(){M(y),C()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,x.jsx)("div",{style:{marginBottom:"10px"},children:_.formatMessage({id:"playground.viewcode.info"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)(u.Z,{copyText:q,langOptions:w,defaultValue:y,showHeader:!0,onChangeLang:function(e){M(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,x.jsx)("div",{style:{paddingRight:2,paddingBottom:2},children:(0,x.jsx)(c.Z,{height:380,theme:"dark",code:q,lang:I,copyable:!1})})}),(0,x.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,x.jsx)(d.Z,{className:"m-r-8"}),(0,x.jsx)("span",{children:_.formatMessage({id:"playground.viewcode.tips"},{here:(0,x.jsx)(f.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,x.jsxs)("span",{children:[" ",_.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})};n.Z=h.memo(C)},49918:function(e,n,a){var t=a(26068),r=a.n(t),l=a(48305),s=a.n(l),i=a(16850),o=a(16333),u=a(90515),c=a(99178),d=a(1956),p=a(85885),m=a(50959),f=a(11527),v="bash",g="python",h="javascript",x=[{label:"Curl",value:v},{label:"Python",value:g},{label:"JavaScript",value:h}];n.Z=function(e){var n=e||{},a=n.title,t=n.open,l=n.onCancel,y=n.payload,b=n.parameters,j=void 0===b?{}:b,w=n.api,C=n.logcommand,k=(0,c.useIntl)(),Z=(0,m.useState)(""),z=s()(Z,2),_=z[0],S=z[1],N=(0,m.useState)(v),I=s()(N,2),M=I[0],L=I[1],q="".concat(window.location.origin).concat(w);return(0,m.useEffect)((function(){!function(){if(M===v){var e="curl ".concat(window.location.origin).concat(w,' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(r()(r()({},j),y),null,2),"'");S(e)}else if(M===h){var n=r()(r()({},j),y),a="import axios from 'axios';\n\nconst url = \"".concat(q,'";\n\nconst headers = ').concat(JSON.stringify({"Content-type":"application/json",Authorization:"Bearer ${YOUR_GPUSTACK_API_KEY}"},null,2),";\n\nconst data = ").concat(JSON.stringify(n,null,2),";\n\naxios.post(url, data, { headers }).then((response) => {\n  console.log(response.").concat(C.node,");\n});");S(a)}else if(M===g){var t=r()(r()({},j),y),l='import requests\n\nurl="'.concat(q,'"\n\nheaders = ').concat(JSON.stringify({"Content-type":"application/json",Authorization:"Bearer ${YOUR_GPUSTACK_API_KEY}"},null,2),"\n\ndata=").concat(JSON.stringify(t,null,2).replace(/null/g,"None"),"\n\nresponse = requests.post(url, headers=headers, json=data)\n\nprint(response.").concat(C.python,")");S(l)}}()}),[M,j,y]),(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.Z,{title:a,open:t,centered:!0,onCancel:function(){L(v),l()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,f.jsx)("div",{style:{marginBottom:"10px"},children:k.formatMessage({id:"playground.viewcode.info"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)(i.Z,{copyText:_,langOptions:x,defaultValue:v,showHeader:!0,onChangeLang:function(e){L(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,f.jsx)(o.Z,{height:380,theme:"dark",code:_,lang:M,copyable:!1})}),(0,f.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,f.jsx)(u.Z,{className:"m-r-8"}),(0,f.jsx)("span",{children:k.formatMessage({id:"playground.viewcode.tips"},{here:(0,f.jsx)(p.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,f.jsxs)("span",{children:[" ",k.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})}},22471:function(e,n,a){a.d(n,{Ci:function(){return o},FM:function(){return l},GF:function(){return i},I_:function(){return t},JY:function(){return r},QU:function(){return s}});var t=[{type:"Select",name:"voice",options:[],label:{text:"playground.params.voice",isLocalized:!0},rules:[{required:!0,message:"Voice is required"}]},{type:"Select",name:"response_format",options:[{label:"mp3",value:"mp3"},{label:"wav",value:"wav"}],label:{text:"playground.params.format",isLocalized:!0},rules:[{required:!1}]}],r=[{type:"Select",name:"language",options:[{label:"Auto",value:"auto"},{label:"English",value:"en"},{label:"中文",value:"zh"},{label:"日本語",value:"ja"},{label:"Français",value:"fr"},{label:"Deutsch",value:"de"}],label:{text:"playground.params.language",isLocalized:!0},rules:[{required:!0}]}],l=[{type:"InputNumber",name:"n",label:{text:"playground.params.counts",isLocalized:!0},attrs:{min:1,max:4},rules:[{required:!1}]},{type:"Select",name:"size",options:[{label:"playground.params.custom",value:"custom",locale:!0},{label:"256x256",value:"256x256"},{label:"512x512",value:"512x512"},{label:"1024x1024",value:"1024x1024"}],description:{text:"playground.params.size.description",html:!0,isLocalized:!0},label:{text:"playground.params.size",isLocalized:!0},rules:[{required:!1}]}],s=[{type:"Select",name:"quality",options:[{label:"playground.params.standard",value:"standard",locale:!0},{label:"playground.params.hd",value:"hd",locale:!0}],label:{text:"playground.params.quality",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"style",options:[{label:"playground.params.style.vivid",value:"vivid",locale:!0},{label:"playground.params.style.natural",value:"natural",locale:!0}],attrs:{allowClear:!0},label:{text:"playground.params.style",isLocalized:!0},rules:[{required:!1}]}],i=[{type:"Select",name:"sampler",options:[{label:"euler_a",value:"euler_a"},{label:"euler",value:"euler"},{label:"heun",value:"heun"},{label:"dpm2",value:"dpm2"},{label:"dpm++2s_a",value:"dpm++2s_a"},{label:"dpm++2m",value:"dpm++2m"},{label:"dpm++2mv2",value:"dpm++2mv2"},{label:"ipndm",value:"ipndm"},{label:"ipndm_v",value:"ipndm_v"},{label:"lcm",value:"lcm"}],label:{text:"playground.image.params.sampler",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"schedule",options:[{label:"discrete",value:"discrete"},{label:"karras",value:"karras"},{label:"exponential",value:"exponential"},{label:"ays",value:"ays"},{label:"gits",value:"gits"}],label:{text:"playground.image.params.schedule",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"sample_steps",label:{text:"playground.image.params.samplerSteps",isLocalized:!0},attrs:{min:1,max:100},rules:[{required:!1}]},{type:"InputNumber",name:"cfg_scale",label:{text:"CFG Scale",isLocalized:!1},attrs:{min:1,max:10,step:.1},rules:[{required:!1}]},{type:"Input",name:"negative_prompt",label:{text:"playground.image.params.negativePrompt",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"seed",label:{text:"playground.image.params.seed",isLocalized:!0},attrs:{min:0},disabledConfig:{depends:["random_seed"],when:function(e){return null==e?void 0:e.random_seed}},rules:[{required:!1}]},{type:"Checkbox",name:"random_seed",label:{text:"playground.image.params.randomseed",isLocalized:!0},rules:[{required:!1}]}],o=[{type:"Slider",name:"width",label:{text:"playground.params.width",isLocalized:!0},attrs:{min:256,max:3200,step:64,inputnumber:!1},rules:[{required:!0,message:"playground.params.width"}]},{type:"Slider",name:"height",label:{text:"playground.params.height",isLocalized:!0},attrs:{min:256,max:3200,step:64,inputnumber:!1},rules:[{required:!0,message:"playground.params.height"}]}]},2221:function(e,n,a){a.r(n),a.d(n,{default:function(){return fe}});var t=a(90228),r=a.n(t),l=a(87999),s=a.n(l),i=a(48305),o=a.n(i),u=a(83057),c=a(35445),d=a(93495),p=a(55592),m=a(55169),f=a(99178),v=a(54235),g=a(85885),h=a(82187),x=a.n(h),y=a(32699),b=a.n(y),j=a(50959),w=a(94299),C=a(35014),k=a(15558),Z=a.n(k),z=a(26068),_=a.n(z),S=a(49662),N=a(67825),I=a.n(N),M=a(88641),L=a(83603),q=a(92233),O=a(42779),A=a(13770),P=a(4423),T=a(68476),E=a(23333),R=a(40474),U=a(96247),F=a(75489),V="slider-label___rGKKE",K=a(11527),Y=["label","value","required","description","isInFormItems","max","min","step","defaultValue","checkStatus","inputnumber","labelWidth","tooltip"],H=function(e){var n=e.label,a=e.value,t=e.required,r=e.description,l=e.isInFormItems,s=void 0===l||l,i=e.max,o=e.min,u=e.step,c=e.defaultValue,d=e.checkStatus,p=e.inputnumber,m=void 0!==p&&p,f=e.labelWidth,v=e.tooltip,g=void 0===v?{open:!1}:v,h=I()(e,Y),x="";if(s){var y,b,w=null===T.Z||void 0===T.Z||null===(y=T.Z.Item)||void 0===y||null===(b=y.useStatus)||void 0===b?void 0:b.call(y);x=(null==w?void 0:w.status)||""}var C=function(n){var a,t=n||0;null===(a=e.onChange)||void 0===a||a.call(e,t)},k=j.useMemo((function(){return(0,K.jsxs)("span",{className:V,style:{width:f||A.d.mini},children:[(0,K.jsx)("span",{className:"text",children:r?(0,K.jsxs)(E.Z,{title:r,children:[(0,K.jsxs)("span",{children:[" ",n]}),(0,K.jsx)("span",{className:"m-l-5",children:(0,K.jsx)(P.Z,{})})]}):(0,K.jsx)("span",{children:n})}),m?(0,K.jsx)(R.Z,{className:"label-val",variant:"outlined",size:"small",value:a,controls:!1,onChange:C}):(0,K.jsx)("span",{className:"val",children:a})]})}),[n,f,r,a,i,o,u,c]);return(0,K.jsx)(F.Z,{required:t,status:d||x,label:k,style:{padding:"20px 2px 0"},variant:"borderless",children:(0,K.jsx)(U.Z,_()(_()({},h),{},{defaultValue:c,max:i,min:o,step:u,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:g,value:a,onChange:function(n){var a;null===(a=e.onChange)||void 0===a||a.call(e,n)}}))})},J={InputNumber:q.Z.Number,Select:O.Z,Slider:H,TextArea:q.Z.TextArea,Input:q.Z.Input,Checkbox:L.Z},B=["type","label","attrs","style","value"],G=function(e){var n=(0,f.useIntl)(),a=e.type,t=e.label,r=e.attrs,l=e.style,s=e.value,i=I()(e,B),o=(0,j.useCallback)((function(a){return"Checkbox"===a?(0,K.jsx)(M.Z,{required:e.required,label:t.isLocalized?n.formatMessage({id:t.text}):t.text}):null}),[n,a]),u=(0,j.useMemo)((function(){return"Checkbox"===a?{checked:s}:{value:s}}),[a,s]);return j.createElement(J[a],_()(_()(_()(_()({},i),r),u),{},{style:_()(_()({},l),{},{width:"100%"}),label:t.isLocalized?n.formatMessage({id:t.text}):t.text}),o(a))},W=j.memo(G),D=a(571),$=a(38852),Q=a(71239),X=a(81117),ee=a(17485),ne=a(67201),ae=a(76571),te=(a(72183),a(9298)),re=a(22471),le=(a(51662),a(21435),a(76483)),se=a(26598),ie=a(19748),oe=a(49918),ue={seed:null,sampler:"euler_a",cfg_scale:4.5,sample_steps:10,negative_prompt:null,schedule:"discrete"},ce={quality:"standard",style:null},de=_()({n:1,size:"512x512"},ue),pe=(0,j.forwardRef)((function(e,n){var a,t=e.modelList,l=(0,j.useRef)(0),i=(0,j.useState)(!1),c=o()(i,2),d=c[0],p=c[1],m=(0,j.useState)([]),v=o()(m,2),h=v[0],y=v[1],w=(0,f.useIntl)(),k=(0,f.useSearchParams)(),z=o()(k,1)[0].get("model")||"",N=(0,j.useState)({}),I=o()(N,2),M=I[0],L=I[1],q=(0,j.useState)(!1),A=o()(q,2),P=A[0],R=A[1],U=(0,j.useState)(!1),F=o()(U,2),V=F[0],Y=F[1],H=(0,j.useState)(null),J=o()(H,2),B=J[0],G=J[1],pe=(0,j.useState)(!1),me=o()(pe,2),fe=me[0],ve=me[1],ge=(0,j.useRef)(null),he=(0,j.useRef)(null),xe=(0,j.useRef)(0),ye=(0,j.useRef)(null),be=(0,j.useState)(""),je=o()(be,2),we=je[0],Ce=je[1],ke=(0,j.useRef)(null),Ze=(0,j.useRef)(null),ze=T.Z.useWatch("size",null===(a=ke.current)||void 0===a?void 0:a.form),_e=(0,D.Z)(),Se=_e.initialize,Ne=_e.updateScrollerPosition,Ie=(0,D.Z)().initialize;(0,j.useImperativeHandle)(n,(function(){return{viewCode:function(){R(!0)},setCollapse:function(){ve(!fe)},collapse:fe}}));var Me=(0,j.useCallback)((function(){var e,n,a,t=(n=0,a=te.ce.length-1,Math.floor(Math.random()*(a-n+1)+n)),r=te.ce[t];null===(e=Ze.current)||void 0===e||e.handleInputChange({target:{value:r}})}),[]),Le=(0,j.useCallback)((function(){var e={span:12};return 1===M.n&&(e.span=24),2===M.n&&(e.span=12),3===M.n&&(e.span=12),4===M.n&&(e.span=12),e}),[M.n]),qe=(0,j.useMemo)((function(){return"custom"===M.size?_()(_()({},b().omit(M,["width","height"])),{},{size:M.width&&M.height?"".concat(M.width,"x").concat(M.height):""}):_()({},b().omit(M,["width","height","random_seed"]))}),[M]),Oe=function(){return l.current=l.current+1,l.current},Ae=function(){var e=s()(r()().mark((function e(n){var a,t,l,s,i,o,u,c,d,p,m,f,v,g,h;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(a=ke.current)||void 0===a||null===(a=a.form)||void 0===a?void 0:a.validateFields();case 3:if(M.model){e.next=5;break}return e.abrupt("return");case 5:return i=Le(),Y(!0),Oe(),G(null),Ce((null==n?void 0:n.content)||""),o=b().split(qe.size,"x"),u=Array(M.n).fill({}).map((function(e,n){return _()(_()({dataUrl:"data:image/png;base64,"},i),{},{progress:0,height:o[1],width:o[0],loading:!0,uid:Oe()})})),y(u),null===(t=ye.current)||void 0===t||null===(l=t.abort)||void 0===l||l.call(t),ye.current=new AbortController,c=_()(_()({},b().omitBy(qe,(function(e){return!e}))),{},{seed:M.random_seed?(0,Q.Hq)():M.seed,stream:!0,stream_options:{chunk_size:16384,chunk_results:!0},prompt:(null==n?void 0:n.content)||we||""}),L(_()(_()({},M),{},{seed:c.seed})),null===(s=ke.current)||void 0===s||null===(s=s.form)||void 0===s||s.setFieldValue("seed",c.seed),e.next=20,(0,X.U3)({data:c,url:"".concat(C.U$,"?t=").concat(Date.now()),signal:ye.current.signal});case 20:if(!(d=e.sent).error){e.next=25;break}return G({error:!0,errorMessage:(null==d||null===(p=d.data)||void 0===p||null===(p=p.error)||void 0===p?void 0:p.message)||(null==d||null===(m=d.data)||void 0===m?void 0:m.error)||""}),y([]),e.abrupt("return");case 25:return f=d.reader,v=d.decoder,e.next=28,(0,X.YT)(f,v,(function(e){var n,a;null!=e&&e.error?G({error:!0,errorMessage:(null==e||null===(a=e.error)||void 0===a?void 0:a.message)||(null==e?void 0:e.message)||""}):(null==e||null===(n=e.data)||void 0===n||n.forEach((function(e){var n=u[e.index];e.b64_json&&(n.dataUrl+=e.b64_json);var a=b().round(e.progress,0);u[e.index]={dataUrl:n.dataUrl,height:o[1],width:o[0],maxHeight:"".concat(o[1],"px"),maxWidth:"".concat(o[0],"px"),uid:n.uid,span:n.span,loading:a<100,progress:a}})),y(Z()(u)))}));case 28:e.next=35;break;case 30:e.prev=30,e.t0=e.catch(0),null===(g=ye.current)||void 0===g||null===(h=g.abort)||void 0===h||h.call(g),y([]);case 35:return e.prev=35,Y(!1),e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[0,30,35,38]])})));return function(n){return e.apply(this,arguments)}}(),Pe=function(){R(!1)},Te=(0,j.useMemo)((function(){return d?re.QU.map((function(e){return(0,K.jsx)(T.Z.Item,{name:e.name,rules:e.rules,children:(0,K.jsx)(O.Z,_()(_()({},e.attrs),{},{options:e.options,label:e.label.isLocalized?w.formatMessage({id:e.label.text}):e.label.text}))},e.name)})):[]}),[re.QU,d,w]),Ee=function(e){var n;e.target.id.indexOf("random_seed")>-1&&(null===(n=ke.current)||void 0===n||null===(n=n.form)||void 0===n||n.setFieldValue("random_seed",e.target.checked),L((function(n){return _()(_()({},n),{},{random_seed:e.target.checked})})))},Re=(0,j.useMemo)((function(){var e;if(d)return[];var n=null===(e=ke.current)||void 0===e||null===(e=e.form)||void 0===e?void 0:e.getFieldsValue();return re.GF.map((function(e){var a,t;return(0,K.jsx)(T.Z.Item,{name:e.name,rules:e.rules,noStyle:"random_seed"===e.name,children:(0,K.jsx)(W,_()({style:"random_seed"===e.name?{marginBottom:20}:{},disabled:e.disabledConfig?null===(a=e.disabledConfig)||void 0===a||null===(t=a.when)||void 0===t?void 0:t.call(a,n):e.disabled,onChange:"random_seed"===e.name?Ee:null},b().omit(e,["name","rules","disabledConfig"])))},e.name)}))}),[re.GF,d,w,ke.current]),Ue=(0,j.useMemo)((function(){return"custom"===ze?re.Ci.map((function(e){var n,a;return(0,K.jsx)(T.Z.Item,{name:e.name,rules:[{message:w.formatMessage({id:"common.form.rule.input"},{name:w.formatMessage({id:e.label.text})}),required:!0}],children:(0,K.jsx)(W,_()(_()({label:e.label.isLocalized?w.formatMessage({id:e.label.text}):e.label.text,description:null!==(n=e.description)&&void 0!==n&&n.isLocalized?w.formatMessage({id:e.description.text}):null===(a=e.description)||void 0===a?void 0:a.text},e.attrs),b().omit(e,["name","description","rules","disabledConfig"])))},e.name)})):null}),[ze,w]);return(0,j.useEffect)((function(){return function(){var e,n;null===(e=ye.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e)}}),[]),(0,j.useEffect)((function(){var e;"custom"===ze&&(null===(e=ke.current)||void 0===e||null===(e=e.form)||void 0===e||e.setFieldsValue({width:512,height:512}),L((function(e){return _()(_()({},e),{},{width:512,height:512})})))}),[ze]),(0,j.useEffect)((function(){ge.current&&Se(ge.current)}),[ge.current,Se]),(0,j.useEffect)((function(){he.current&&Ie(he.current)}),[he.current,Ie]),(0,j.useEffect)((function(){V&&Ne()}),[h,V]),(0,j.useEffect)((function(){h.length>xe.current&&Ne(),xe.current=h.length}),[h.length]),(0,K.jsxs)("div",{className:"ground-left-wrapper",children:[(0,K.jsxs)("div",{className:"ground-left",children:[(0,K.jsx)("div",{className:"message-list-wrap",ref:ge,style:{paddingBottom:16},children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:"content",style:{height:"100%"},children:[(0,K.jsx)($.Z,{style:{padding:0,height:"100%",justifyContent:"center",flexDirection:"column",flexWrap:"unset",alignItems:"center"},autoBgColor:!1,editable:!1,dataList:h,loading:V,responseable:!0,gutter:[8,16],autoSize:!0}),!h.length&&(0,K.jsxs)("div",{className:"flex-column font-size-14 flex-center gap-20 justify-center hold-wrapper",children:[(0,K.jsx)("span",{children:(0,K.jsx)(ee.Z,{className:"font-size-32 text-secondary"})}),(0,K.jsx)("span",{children:w.formatMessage({id:"playground.params.empty.tips"})})]})]})})}),B&&(0,K.jsx)("div",{style:{height:40},children:(0,K.jsx)(S.Z,{type:"danger",message:null==B?void 0:B.errorMessage})}),(0,K.jsx)("div",{className:"ground-left-footer",children:(0,K.jsx)(se.Z,{ref:Ze,placeholer:w.formatMessage({id:"playground.input.prompt.holder"}),actions:["clear"],defaultSize:{minRows:5,maxRows:5},loading:V,disabled:!M.model,isEmpty:!h.length,handleSubmit:function(e){var n=e.content?e:void 0;Ae(n)},handleAbortFetch:function(){var e,n;null===(e=ye.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),Y(!1)},onInputChange:function(e){Ce(e.target.value)},shouldResetMessage:!1,clearAll:function(){Oe(),y([]),G(null)},tools:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("span",{className:"font-600",children:w.formatMessage({id:"playground.image.prompt"})}),(0,K.jsx)(ae.Z,{type:"vertical"}),(0,K.jsx)(E.Z,{title:w.formatMessage({id:"playground.image.prompt.random"}),children:(0,K.jsx)(g.ZP,{onClick:Me,size:"middle",type:"text",icon:(0,K.jsx)(u.Z,{type:"icon-random"})})})]})})})]}),(0,K.jsx)("div",{className:x()("params-wrapper",{collapsed:fe}),ref:he,children:(0,K.jsx)("div",{className:"box",children:(0,K.jsx)(le.Z,{ref:ke,parametersTitle:(0,K.jsxs)("div",{className:"flex-between flex-center",children:[(0,K.jsx)("span",{children:w.formatMessage({id:"playground.parameters"})}),(0,K.jsx)(E.Z,{title:w.formatMessage({id:"playground.image.params.custom.tips"}),children:(0,K.jsx)(g.ZP,{size:"middle",type:"text",icon:(0,K.jsx)(ne.Z,{}),onClick:function(){var e,n;d?(null===(e=ke.current)||void 0===e||null===(e=e.form)||void 0===e||e.setFieldsValue(_()({},ue)),L((function(e){return _()(_()({},b().omit(e,b().keys(ce))),ue)}))):(null===(n=ke.current)||void 0===n||null===(n=n.form)||void 0===n||n.setFieldsValue(_()({},ce)),L((function(e){return _()(_()({},ce),b().omit(e,b().keys(ue)))})));p(!d)},children:d?w.formatMessage({id:"playground.image.params.custom"}):w.formatMessage({id:"playground.image.params.openai"})})})]}),setParams:L,paramsConfig:re.FM,initialValues:de,params:M,selectedModel:z,modelList:t,extra:[Ue].concat(Z()(Te),Z()(Re))})})}),d?(0,K.jsx)(ie.Z,_()(_()({},te.NW.images),{},{open:P,payload:{prompt:we},parameters:_()({},qe),onCancel:Pe,title:w.formatMessage({id:"playground.viewcode"})})):(0,K.jsx)(oe.Z,_()(_()({},te.NW.imageAdvanced),{},{open:P,payload:{prompt:we},parameters:_()({},qe),onCancel:Pe,title:w.formatMessage({id:"playground.viewcode"})}))]})})),me=(0,j.memo)(pe),fe=(a(20988),function(){var e=(0,f.useIntl)(),n=(0,p.Z)().size,a=(0,j.useRef)(null),t=(0,j.useState)([]),l=o()(t,2),i=l[0],h=l[1],y=(0,j.useState)(!1),k=o()(y,2),Z=(k[0],k[1]),z=(0,j.useCallback)((function(){var e,n;null===(e=a.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e)}),[]),_=(0,j.useCallback)((function(){var e,n;null===(e=a.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),[]);(0,j.useEffect)((function(){var e,t,r;n.width<c.Z.lg&&(null!==(e=a.current)&&void 0!==e&&e.collapse||null===(t=a.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t))}),[n.width]),(0,j.useEffect)((function(){var e=function(){var e=s()(r()().mark((function e(){var n,a,t;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={image_only:!0},e.next=4,(0,C.nb)(n);case 4:return a=e.sent,t=b().map(a.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var n=s()(r()().mark((function n(){var a;return r()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:a=n.sent,h(a),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),Z(!0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();n()}),[]);return(0,w.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=a.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,K.jsx)(m._z,{ghost:!0,header:{title:e.formatMessage({id:"menu.playground.text2images"}),breadcrumb:{}},extra:(0,K.jsxs)(v.Z,{children:[(0,K.jsx)(g.ZP,{size:"middle",onClick:z,icon:(0,K.jsx)(u.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,K.jsx)(g.ZP,{size:"middle",onClick:_,icon:(0,K.jsx)(u.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:x()("playground-container chat"),children:(0,K.jsx)("div",{className:"play-ground",children:(0,K.jsx)("div",{className:"chat",children:(0,K.jsx)(me,{ref:a,modelList:i})})})})})},81117:function(e,n,a){a.d(n,{LN:function(){return v},U3:function(){return f},YT:function(){return h}});var t=a(335),r=a.n(t),l=a(90228),s=a.n(l),i=a(26068),o=a.n(i),u=a(87999),c=a.n(u),d=a(55360),p=/data:\s*({.*?})(?=\n|$)/g,m=function(e){var n,a=[];if(!e)return a;for(;null!==(n=p.exec(e));)try{var t=JSON.parse(n[1]);a.push(t)}catch(e){continue}return a},f=function(){var e=c()(s()().mark((function e(n){var a,t,r,l,i,u;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.method||"POST",r=n.url,n.params&&(r="".concat(r,"?").concat(d.Z.stringify(n.params))),e.next=5,fetch(r,{method:t,body:"POST"===t?JSON.stringify(n.data):null,signal:n.signal,headers:o()({"Content-Type":"application/json"},n.headers)});case 5:if((l=e.sent).ok){e.next=12;break}return e.next=10,l.json();case 10:return e.t0=e.sent,e.abrupt("return",{error:!0,data:e.t0});case 12:return i=null==l||null===(a=l.body)||void 0===a?void 0:a.getReader(),u=new TextDecoder("utf-8",{fatal:!0}),e.abrupt("return",{reader:i,decoder:u});case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=c()(s()().mark((function e(n,a,t){var r,l,i,o;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.read();case 2:if(r=e.sent,l=r.done,i=r.value,!l){e.next=7;break}return e.abrupt("return");case 7:return o=a.decode(i,{stream:!0}),m(o).forEach((function(e){null==t||t(e)})),e.next=11,v(n,a,t);case 11:case"end":return e.stop()}}),e)})));return function(n,a,t){return e.apply(this,arguments)}}(),g=function(e,n){var a,t=e.split("\n"),l=r()(t);try{for(l.s();!(a=l.n()).done;){var s=a.value;if(s.startsWith("data: ")){var i=s.slice(6).trim();try{n(JSON.parse(i))}catch(e){}}}}catch(e){l.e(e)}finally{l.f()}},h=function(){var e=c()(s()().mark((function e(n,a,t){var l,i,o,u,c,d,p,m,f,v,h;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l="";case 1:return e.next=4,null==n||null===(i=n.read)||void 0===i?void 0:i.call(n);case 4:if(o=e.sent,u=o.done,c=o.value,!u){e.next=10;break}return l.trim()&&g(l,t),e.abrupt("break",17);case 10:l+=a.decode(c,{stream:!0}),d=l.split("\n"),l=d.pop()||"",p=r()(d);try{for(p.s();!(m=p.n()).done;)if((f=m.value).startsWith("data: ")){v=f.slice(6).trim();try{"[DONE]"!==v&&(h=JSON.parse(v),t(h))}catch(e){}}}catch(e){p.e(e)}finally{p.f()}e.next=1;break;case 17:case"end":return e.stop()}}),e)})));return function(n,a,t){return e.apply(this,arguments)}}()}}]);