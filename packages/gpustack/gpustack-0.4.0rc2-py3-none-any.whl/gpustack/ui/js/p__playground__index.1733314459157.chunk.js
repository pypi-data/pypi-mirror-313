"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8268],{33883:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(26068),a=n.n(r),s=n(48305),i=n.n(s),l=n(67825),o=n.n(l),c=n(23333),u=n(76808),d=n(32699),f=n(50959),m=n(571),p=n(11527),h=function(e){var t=e.isOverflowing,n=e.showTitle,r=e.title,a=e.children,s=(0,m.Z)().initialize,i=f.useRef(null);return f.useEffect((function(){i.current&&s(i.current)}),[s,i.current]),(0,p.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},ref:i,children:(0,p.jsx)("div",{style:{width:"max-content",maxWidth:250,paddingInline:10},children:t||n?r||a:""})})},g=f.memo(h),v=["children","maxWidth","minWidth","ghost","title","showTitle","tooltipProps"],x=function(e){var t=e.children,n=e.maxWidth,r=void 0===n?"100%":n,s=e.minWidth,l=e.ghost,m=void 0!==l&&l,h=e.title,x=e.showTitle,y=void 0!==x&&x,b=e.tooltipProps,w=o()(e,v),j=(0,f.useRef)(null),k=(0,f.useState)(!1),Z=i()(k,2),S=Z[0],M=Z[1],N=((0,f.useRef)(),(0,f.useCallback)((function(){if(j.current){var e=j.current,t=e.scrollWidth,n=e.clientWidth;M(t>n)}}),[j.current]));(0,f.useEffect)((function(){var e=(0,d.throttle)(N,200);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[N]),(0,f.useEffect)((function(){N()}),[t,N]);var T=(0,f.useMemo)((function(){return a()({maxWidth:r,minWidth:s,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},w.style)}),[r,w.style]);return(0,p.jsx)(c.Z,a()(a()({overlayInnerStyle:{paddingInline:0},destroyTooltipOnHide:!1,title:S||y?(0,p.jsx)(g,{isOverflowing:S,title:h,showTitle:y,children:t}):""},b),{},{children:m?(0,p.jsx)("div",{ref:j,style:T,children:t}):(0,p.jsx)(u.Z,a()(a()({},w),{},{ref:j,style:T,children:t}))}))},y=f.memo(x)},16850:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(26068),a=n.n(r),s=n(60857),i=n(50959),l=n(42034),o=n(11527),c=function(e){var t=e.header,n=e.children,r=e.copyText,i=e.langOptions,c=e.onChangeLang,u=e.defaultValue,d=e.styles,f=void 0===d?{}:d,m=e.showHeader,p=void 0===m||m,h=function(e){null==c||c(e)};return(0,o.jsxs)("div",{className:"editor-wrap",style:a()({},f.wrapper),children:[t?(0,o.jsx)("div",{className:"editor-header",children:t}):p?(0,o.jsxs)("div",{className:"editor-header",children:[(0,o.jsx)(s.default,{defaultValue:u,style:{width:120},size:"middle",variant:"filled",options:i,onChange:h}),(0,o.jsx)(l.Z,{text:r,size:"small",style:{color:"rgba(255,255,255,.7)"}})]}):null,(0,o.jsx)("div",{className:"editor-content",children:n})]})},u=i.memo(c)},75489:function(e,t,n){var r=n(26068),a=n.n(r),s=n(82187),i=n.n(s),l=(n(50959),n(88641)),o=n(1066),c=n(11527);t.Z=function(e){var t=e.children,n=e.label,r=e.status,s=e.className,u=e.disabled,d=e.required,f=e.variant,m=e.style,p=e.description;return(0,c.jsxs)("div",{style:a()({padding:"0 calc(var(--ant-padding-sm) - 5px)",width:"100%"},m),className:i()(o.Z.wrapper,o.Z["validate-status-".concat(r)],u?o.Z["seal-input-wrapper-disabled"]:"","filled"===f?o.Z.filled:"","borderless"===f?o.Z.borderless:"",s?o.Z[s]:""),children:[(0,c.jsx)("label",{className:i()(o.Z.label,o.Z["isfoucs-has-value"]),children:(0,c.jsx)(l.Z,{label:n,required:d,description:p})}),(0,c.jsx)("div",{className:"child-inner",style:{width:"100%"},children:t})]})}},13770:function(e,t,n){n.d(t,{d:function(){return r}});var r={default:500,large:600,small:400,mini:300}},35014:function(e,t,n){n.d(t,{AA:function(){return d},U$:function(){return c},jQ:function(){return m},nb:function(){return u},qt:function(){return o},wE:function(){return p},xO:function(){return f},zv:function(){return h}});var r=n(90228),a=n.n(r),s=n(87999),i=n.n(s),l=n(99178),o="/v1-openai/chat/completions",c="/v1-openai/images/generations";var u=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat("/v1-openai/models"),{method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=i()(a()().mark((function e(t,n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat("/rerank"),{method:"POST",data:t,cancelToken:null==n?void 0:n.cancelToken}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=i()(a()().mark((function e(t,n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat("/v1-openai/embeddings"),{method:"POST",data:t,cancelToken:null==n?void 0:n.cancelToken}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=i()(a()().mark((function e(t,n){var r,s,i,l;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/v1-openai/audio/speech",{method:"POST",body:JSON.stringify(t.data),signal:t.signal});case 2:if((s=e.sent).ok){e.next=7;break}return e.next=6,s.json();case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,s.blob();case 9:if(-1!==(null==(i=e.sent)||null===(r=i.type)||void 0===r?void 0:r.indexOf("audio"))){e.next=12;break}return e.abrupt("return",{url:"",type:""});case 12:return l=i.size>0?URL.createObjectURL(i):"",e.abrupt("return",{url:l,type:i.type});case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=i()(a()().mark((function e(t,n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/v1-openai/audio/transcriptions",{method:"POST",data:t.data,cancelToken:null==n?void 0:n.cancelToken,headers:{"Content-Type":"multipart/form-data"}}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("/voices",{method:"GET",params:t,skipErrorHandler:!0}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},9298:function(e,t,n){n.d(t,{G7:function(){return r},NW:function(){return s},ce:function(){return i},kA:function(){return a}});n(26068),n(32699);var r={User:"user",Assistant:"assistant",System:"system"},a=(r.User,r.Assistant,function(e){if(!e.length)return[];var t=[];return e.forEach((function(e){var n;if(null!==(n=e.imgs)&&void 0!==n&&n.length){var r=e.imgs.map((function(e){return{type:"image_url",image_url:{url:e.dataUrl}}}));t.push({role:e.role,content:r})}e.content&&t.push({role:e.role,content:e.content})})),t}),s={chat:{api:"chat/completions",clientType:"chat.completions.create",logcommand:"choices[0].message.content"},embeddings:{api:"embeddings",clientType:"embedding.create",logcommand:"data[0].embedding"},images:{api:"images/generations",clientType:"images.generate",logcommand:"data[0].b64_json"},imageAdvanced:{api:"/v1-openai/images/generations",clientType:"images.generate",logcommand:{python:"json()['data'][0]['b64_json']",node:"data.data[0].b64_json"}},rerank:{api:"/v1/rerank",logcommand:{python:"json()",node:"data"}}},i=["a lovely cat.","Digital art, portrait of an anthropomorphic roaring Tiger warrior with full armor, close up in the middle of a battle, behind him there is a banner with the text 'Open Source'.","An astronaut riding a green horse.","a female character with long, flowing hair that appears to be made of ethereal, swirling patterns resembling the Northern Lights or Aurora Borealis. The background is dominated by deep blues and purples, creating a mysterious and dramatic atmosphere. The character's face is serene, with pale skin and striking features. She wears a dark-colored outfit with subtle patterns. The overall style of the artwork is reminiscent of fantasy or supernatural genres.","A whimsical and creative image depicting a hybrid creature that is a mix of a waffle and a hippopotamus, basking in a river of melted butter amidst a breakfast-themed landscape. It features the distinctive, bulky body shape of a hippo. However, instead of the usual grey skin, the creature's body resembles a golden-brown, crispy waffle fresh off the griddle. The skin is textured with the familiar grid pattern of a waffle, each square filled with a glistening sheen of syrup. The environment combines the natural habitat of a hippo with elements of a breakfast table setting, a river of warm, melted butter, with oversized utensils or plates peeking out from the lush, pancake-like foliage in the background, a towering pepper mill standing in for a tree.  As the sun rises in this fantastical world, it casts a warm, buttery glow over the scene. The creature, content in its butter river, lets out a yawn. Nearby, a flock of birds take flight.","A cinematic shot of a baby racoon wearing an intricate italian priest robe.","Create portraits of characters in the style of classical oil painting, Capturing the essence of Chinese aristocracy in the Han Dynasty period. This portrait should feature a Chinese male character dressed in exquisite and gorgeous Chinese Han style clothing, with a dignified demeanor. The background should be a simple and elegant wallpaper pattern, with the face and upper body of the character as the focus. The lighting should be soft and diffuse, highlighting the characteristics of the character and the complex details of the clothing. The color palette should be rich and warm, with red, gold, and dark green.","photo of a young woman with long, wavy brown hair tied in a bun and glasses. She has a fair complexion and is wearing subtle makeup, emphasizing her eyes and lips. She is dressed in a black top. The background appears to be an urban setting with a building facade, and the sunlight casts a warm glow on her face.","A portrait of women with blue eyes.","A close-up image of a light brown and cream-colored Bengal kitten, lying on a cream-colored surface, with a person's hand gently touching the kitten's head, capturing the soft textures of the fur and the subtle patterns, emphasizing the natural light and shadow play on the animal's body.","A German Shepherd dog playfully carrying a stick, with a smaller German Shepherd puppy running alongside in a grassy field, showcasing a rich, natural color palette of greens, browns, and tans, and a dynamic action shot with a focus on vibrant texture and depth of field.","A young woman with long, dark, wavy hair, wearing a light olive green flowing dress, looks directly at the camera, standing near a window with a soft out-of-focus background of dark green curtains and light green.  The image should be sharp, focused on the woman's face, and evoke a natural, soft beauty aesthetic with a slightly muted color palette.","A sleepy panda cub rests comfortably on a large, ornate tree branch, its black and white fur contrasting against the reddish-brown bark of the textured, sculpted tree trunk, surrounded by lush green foliage and branches.  ","A full shot of two people jogging at sunset,  featuring a vibrant, warm color palette shifting from twilight blues to peachy-orange tones, with visible sun rays and lens flares, conveying a sense of leisure and athleticism.","A close-up portrait of a golden retriever wearing black-framed glasses,  exhibiting a rich golden-brown coat with a fluffy texture,  and a neutral, light gray background."]},69406:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ie}});var r=n(90228),a=n.n(r),s=n(87999),i=n.n(s),l=n(48305),o=n.n(l),c=n(83057),u=n(35445),d=n(93495),f=n(55592),m=n(92067),p=n(63830),h=n(55169),g=n(99178),v=n(54235),x=n(85885),y=n(96938),b=n(47946),w=n(82187),j=n.n(w),k=n(32699),Z=n.n(k),S=n(50959),M=n(94299),N=n(35014),T=n(26068),C=n.n(T),R=n(15558),P=n.n(R),_=n(571),A=n(81117),E=n(54876),O=(n(72183),n(9298)),z=(n(51662),n(21435),n(26598)),I=(n(9763),n(42034)),L=n(81e3),F=n(23333),D=n(8267),q=n(38852),G=n(2565),W=n(11527),V=function(e){var t,n,r,s=e.updateMessage,l=e.onDelete,o=e.loading,c=e.data,u=e.editable,d=e.showTitle,f=void 0===d||d,m=e.actions,p=void 0===m?["upload","delete","copy"]:m,h=(0,g.useIntl)(),v=(0,S.useRef)(null),y=(0,S.useRef)(0),b=(0,S.useCallback)(function(){var e=i()(a()().mark((function e(t){var n,r,i,l,o,u,d;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.clipboardData||window.clipboardData,r=n.items,i=[],l=a()().mark((function e(){var t,n,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"file"===(t=r[o]).kind&&-1!==t.type.indexOf("image")?(n=t.getAsFile(),s=new Promise((function(e,t){var r=new FileReader;r.onload=function(n){var r,a=null===(r=n.target)||void 0===r?void 0:r.result;a?e(a):t("Failed to convert image to base64")},r.readAsDataURL(n)})),i.push(s)):t.kind;case 2:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<r.length)){e.next=10;break}return e.delegateYield(l(),"t0",7);case 7:o++,e.next=5;break;case 10:return e.prev=10,e.next=13,Promise.all(i);case 13:(u=e.sent).length&&(d=Z().map(u,(function(e){return y.current+=1,{uid:y.current,dataUrl:e}})),null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(P()(c.imgs||[]),P()(d))})),e.next=20;break;case 17:e.prev=17,e.t1=e.catch(10);case 20:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(t){return e.apply(this,arguments)}}(),[c,s]),w=(0,S.useCallback)((function(e){null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(P()(c.imgs||[]),P()(e))})}),[c,s]),k=function(e){var t=Z().filter(c.imgs,(function(t){return t.uid!==e}));null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:t})},M=(0,S.useCallback)((function(){var e;if(c.imgs&&(null===(e=c.imgs)||void 0===e?void 0:e.length)>0){var t=P()(c.imgs||[]).pop();t&&k(t.uid)}}),[c.imgs,k]),N=(0,S.useCallback)((function(e){var t;"Backspace"===e.key&&""===c.content&&c.imgs&&(null===(t=c.imgs)||void 0===t?void 0:t.length)>0&&(e.preventDefault(),M())}),[c,M]);return(0,W.jsxs)("div",{className:"content-item",children:[(0,W.jsxs)("div",{className:"content-item-role",style:{display:f||p.length?"flex":"none"},children:[f&&(0,W.jsx)("div",{className:"role",children:null!==(t=c.title)&&void 0!==t?t:h.formatMessage({id:"playground.".concat(c.role)})}),(0,W.jsxs)("div",{className:"actions",children:[p.includes("upload")&&c.role===O.G7.User&&(0,W.jsx)(G.Z,{handleUpdateImgList:w}),c.content&&p.includes("copy")&&(0,W.jsx)(I.Z,{text:c.content,size:"small",shape:"default",type:"text",fontSize:"12px"}),p.includes("delete")&&(0,W.jsx)(F.Z,{title:h.formatMessage({id:"common.button.delete"}),children:(0,W.jsx)(x.ZP,{size:"small",type:"text",onClick:l,icon:(0,W.jsx)(L.Z,{})})})]})]}),u?(0,W.jsxs)("div",{className:j()("message-content-input",{"has-img":null===(n=c.imgs)||void 0===n?void 0:n.length}),onClick:function(e){e.stopPropagation(),e.preventDefault(),v.current.focus()},children:[(0,W.jsx)(q.Z,{editable:u,dataList:c.imgs||[],onDelete:k}),(0,W.jsx)(D.Z.TextArea,{ref:v,value:c.content,variant:"filled",autoSize:{minRows:1},style:{borderRadius:"var(--border-radius-mini)"},readOnly:o,onKeyDown:N,onChange:function(e){null==s||s({imgs:c.imgs||[],role:c.role,content:e.target.value,uid:c.uid})},onPaste:function(e){e.clipboardData.getData("text")||(e.preventDefault(),b(e))}})]}):(0,W.jsxs)("div",{className:j()("content-item-content",{"has-img":null===(r=c.imgs)||void 0===r?void 0:r.length}),children:[(0,W.jsx)(q.Z,{editable:u,dataList:c.imgs||[],onDelete:k}),c.content&&(0,W.jsx)("div",{className:"text",children:c.content})]})]})},U=S.memo(V),B=function(e){var t=e.setMessageList,n=e.messageList,r=e.editable,a=e.showTitle,s=void 0===a||a,i=e.actions,l=void 0===i?["upload","delete","copy"]:i;return(0,W.jsx)(W.Fragment,{children:!!n.length&&(0,W.jsx)("div",{className:"message-content-list",children:n.map((function(e,a){return(0,W.jsx)(U,{data:e,editable:r,actions:l,showTitle:s,onDelete:function(){return function(e){var r=P()(n);r.splice(e,1),null==t||t(r)}(a)},updateMessage:function(e){return function(e,r){var a=P()(n);a[e]=r,null==t||t(a)}(a,e)}},e.uid)}))})})},H=S.memo(B),J=n(43943),Y=n(83603),K=n(76571),$=function(e){var t=e.systemMessage,n=e.showApplyToAll,r=e.setSystemMessage,a=e.style,s=e.applyToAll,i=(0,g.useIntl)(),l=(0,S.useState)(!1),c=o()(l,2),u=c[0],d=c[1],f=S.useRef(null),m=(0,S.useState)({minRows:1,maxRows:1,focus:!1}),p=o()(m,2),h=p[0],v=p[1],y=function(){v({minRows:4,maxRows:4,focus:!0}),setTimeout((function(){var e,t;null===(e=f.current)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,{cursor:"end"})}),100)};return(0,S.useEffect)((function(){u&&(null==s||s(t))}),[u]),(0,W.jsxs)("div",{className:j()("sys-message",{focus:h.focus}),style:C()({},a),children:[(0,W.jsxs)("div",{style:{display:h.focus?"block":"none"},className:"textarea-wrapper",children:[(0,W.jsx)("span",{className:"system-label",children:i.formatMessage({id:"playground.systemMessage"})}),(0,W.jsx)(D.Z.TextArea,{className:"custome-scrollbar",ref:f,variant:"filled",placeholder:i.formatMessage({id:"playground.system.tips"}),style:{borderRadius:"0",border:"none"},value:t,autoSize:{minRows:h.minRows,maxRows:h.maxRows},onFocus:y,onBlur:function(e){v({minRows:1,maxRows:1,focus:!1})},allowClear:!1,onChange:function(e){r(e.target.value),u&&(null==s||s(e.target.value))}}),n&&(0,W.jsxs)("span",{className:"apply-check",onMouseDown:function(e){e.preventDefault(),d(!u)},children:[(0,W.jsx)("span",{className:"m-r-5",children:i.formatMessage({id:"playground.compare.applytoall"})}),(0,W.jsx)(Y.Z,{checked:u})]}),(0,W.jsx)(K.Z,{style:{margin:"0"}})]}),!h.focus&&(0,W.jsxs)("div",{className:"sys-content-wrap",onClick:y,children:[(0,W.jsxs)("div",{className:"sys-content",children:[(0,W.jsx)("span",{className:"title",children:i.formatMessage({id:"playground.systemMessage"})}),t||(0,W.jsx)("span",{style:{color:"var(--ant-color-text-tertiary)"},children:i.formatMessage({id:"playground.system.tips"})})]}),t&&(0,W.jsx)(F.Z,{title:i.formatMessage({id:"common.button.clear"}),children:(0,W.jsx)(x.ZP,{className:"clear-btn",type:"text",icon:(0,W.jsx)(J.Z,{}),size:"small",onClick:function(){r("")}})})]})]})},Q=S.memo($),X=n(82092),ee=n.n(X),te=n(75489),ne=n(92233),re=n(42779),ae=n(13770),se=n(4423),ie=n(68476),le=n(40474),oe=n(96247),ce=n(26938),ue=function(e){var t=e.selectedModel,n=e.setParams,r=e.globalParams,a=e.onValuesChange,s=e.modelList,i=e.showModelSelector,l=void 0===i||i,c=(0,g.useIntl)(),u=C()({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024},r),d=ie.Z.useForm(),f=o()(d,1)[0],m=(0,S.useId)();(0,S.useEffect)((function(){l?(f.setFieldsValue(C()(C()({},u),{},{model:t||Z().get(s,"[0].value")})),n(C()(C()({},u),{},{model:t||Z().get(s,"[0].value")}))):(f.setFieldsValue(C()(C()({},u),{},{model:t||""})),n(C()(C()({},u),{},{model:t||""})))}),[s,l,t]);var p=(0,S.useCallback)((function(e,t){null==n||n(t),null==a||a(e,t)}),[a,n]),h=(0,S.useCallback)((function(e,t){var r=f.getFieldsValue();f.setFieldsValue(C()(C()({},r),{},ee()({},t,e))),n(C()(C()({},r),{},ee()({},t,e))),null==a||a(ee()({},t,e),C()(C()({},r),{},ee()({},t,e)))}),[f,n,a]);(0,S.useEffect)((function(){f.setFieldsValue(r)}),[r]);var v=function(e){return(0,W.jsxs)("span",{className:ce.Z.label,style:{width:ae.d.mini},children:[(0,W.jsx)("span",{className:"text",children:e.description?(0,W.jsxs)(F.Z,{title:e.description,children:[(0,W.jsxs)("span",{children:[" ",e.label]}),(0,W.jsx)("span",{className:"m-l-5",children:(0,W.jsx)(se.Z,{})})]}):(0,W.jsx)("span",{children:e.label})}),(0,W.jsx)(le.Z,{className:"label-val",variant:"outlined",size:"small",value:f.getFieldValue(e.field),controls:!1,onChange:function(t){return h(t,e.field)}})]})};return(0,W.jsx)(ie.Z,{name:m,form:f,onValuesChange:p,onFinish:function(e){},onFinishFailed:function(e){},children:(0,W.jsxs)("div",{children:[l&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("h3",{className:"m-b-20 m-l-10 font-size-14 line-24",children:c.formatMessage({id:"playground.model"})}),(0,W.jsx)(ie.Z.Item,{name:"model",rules:[{required:!0,message:c.formatMessage({id:"common.form.rule.select"},{name:c.formatMessage({id:"playground.model"})})}],children:(0,W.jsx)(re.Z,{showSearch:!0,options:s})})]}),(0,W.jsx)("h3",{className:"m-b-20 m-l-10 flex-between flex-center font-size-14 line-24",children:(0,W.jsx)("span",{children:c.formatMessage({id:"playground.parameters"})})}),(0,W.jsx)(ie.Z.Item,{name:"temperature",rules:[{required:!1}],children:(0,W.jsx)(te.Z,{label:v({field:"temperature",label:"Temperature",description:c.formatMessage({id:"playground.params.temperature.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,W.jsx)(oe.Z,{defaultValue:1,max:2,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("temperature")||void 0,onChange:function(e){return h(e,"temperature")}})})}),(0,W.jsx)(ie.Z.Item,{name:"max_tokens",rules:[{required:!1}],children:(0,W.jsx)(te.Z,{label:v({field:"max_tokens",label:"Max Tokens",description:c.formatMessage({id:"playground.params.maxtokens.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,W.jsx)(oe.Z,{defaultValue:2048,max:16384,step:1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("max_tokens")||void 0,onChange:function(e){return h(e,"max_tokens")}})})}),(0,W.jsx)(ie.Z.Item,{name:"top_p",rules:[{required:!1}],children:(0,W.jsx)(te.Z,{label:v({field:"top_p",label:"Top P",description:c.formatMessage({id:"playground.params.topp.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,W.jsx)(oe.Z,{defaultValue:1,max:1,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:f.getFieldValue("top_p")||void 0,onChange:function(e){return h(e,"top_p")}})})}),(0,W.jsx)(ie.Z.Item,{name:"seed",rules:[{required:!1}],children:(0,W.jsx)(ne.Z.Number,{label:"Seed",min:0,description:c.formatMessage({id:"playground.params.seed.tips"}),style:{width:ae.d.mini}})}),(0,W.jsx)(ie.Z.Item,{name:"stop",rules:[{required:!1}],normalize:function(e){return e||null},children:(0,W.jsx)(ne.Z.Input,{allowClear:!0,label:"Stop Sequence",description:c.formatMessage({id:"playground.params.stop.tips"}),style:{width:ae.d.mini}})})]})})},de=(0,S.memo)(ue),fe=n(78093),me=n(87497),pe=function(e){var t=(0,g.useIntl)(),n=e.usage,r=e.showOutput,a=void 0===r||r,s=e.scaleable,i=e.fields,l=void 0===i?["completion_tokens","prompt_tokens"]:i;return!n||Z().isEmpty(n)?null:n.error?(0,W.jsxs)(me.Z.Paragraph,{type:"danger",ellipsis:{rows:2,tooltip:null==n?void 0:n.errorMessage},style:{textAlign:"center",paddingBlock:0,margin:0,backgroundColor:"var(--ant-color-error-bg)"},children:[(0,W.jsx)(fe.Z,{className:"m-r-8"}),null==n?void 0:n.errorMessage]}):(0,W.jsxs)("div",{className:j()("reference-params",{scaleable:s}),children:[(0,W.jsx)("span",{className:j()("usage",{scaleable:s}),children:(0,W.jsx)(F.Z,{title:(0,W.jsxs)(v.Z,{children:[l.includes("completion_tokens")&&(0,W.jsxs)("span",{children:[t.formatMessage({id:"playground.completion"}),":"," ",n.completion_tokens]}),l.includes("prompt_tokens")&&(0,W.jsxs)("span",{children:[t.formatMessage({id:"playground.prompt"}),":"," ",n.prompt_tokens]})]}),children:(0,W.jsxs)("span",{children:[t.formatMessage({id:"playground.tokenusage"}),":"," ",n.total_tokens]})})}),a&&(0,W.jsx)("span",{className:j()("usage",{scaleable:s}),children:(0,W.jsx)(F.Z,{title:(0,W.jsxs)(v.Z,{children:[(0,W.jsxs)("span",{children:["TPOT: ",Z().round(n.time_per_output_token_ms,2)||0," ms"]}),(0,W.jsxs)("span",{children:["TTFT: ",Z().round(n.time_to_first_token_ms,2)||0," ms"]})]}),children:(0,W.jsxs)("span",{children:[t.formatMessage({id:"playground.tokenoutput"}),":"," ",Z().round(n.tokens_per_second,2)||0," Tokens/s"]})})})]})},he=n(19748),ge=(0,S.forwardRef)((function(e,t){var n=e.modelList,r=(0,S.useRef)(0),s=(0,S.useState)([]),l=o()(s,2),c=l[0],u=l[1],d=(0,g.useIntl)(),f=(0,g.useSearchParams)(),m=o()(f,1)[0].get("model")||"",p=(0,S.useState)({}),h=o()(p,2),v=h[0],x=h[1],y=(0,S.useState)(""),b=o()(y,2),w=b[0],k=b[1],M=(0,S.useState)(!1),T=o()(M,2),R=T[0],I=T[1],L=(0,S.useState)(!1),F=o()(L,2),D=F[0],q=F[1],G=(0,S.useState)(null),V=o()(G,2),U=V[0],B=V[1],J=(0,S.useState)(!1),Y=o()(J,2),K=Y[0],$=Y[1],X=(0,S.useRef)(""),ee=(0,S.useRef)(null),te=(0,S.useRef)(null),ne=(0,S.useRef)(null),re=(0,S.useRef)(null),ae=(0,S.useRef)(0),se=(0,_.Z)(),ie=se.initialize,le=se.updateScrollerPosition,oe=(0,_.Z)().initialize;(0,S.useImperativeHandle)(t,(function(){return{viewCode:function(){I(!0)},setCollapse:function(){$(!K)},collapse:K}}));var ce=(0,S.useMemo)((function(){return(0,O.kA)([{role:O.G7.System,content:w}].concat(P()(c)))}),[c,w]),ue=function(){r.current=r.current+1},fe=function(e){var t;B(C()({},null!==(t=null==e?void 0:e.usage)&&void 0!==t?t:{})),e&&Z().get(e,"choices",[]).length&&(X.current=X.current+Z().get(e,"choices.0.delta.content",""),u([].concat(P()(c),P()(ne.current),[{role:O.G7.Assistant,content:X.current,uid:r.current}])))},me=function(){var e=i()(a()().mark((function e(t){var n,s,i,l,o,d,f,m,p,h,g;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,q(!0),ue(),B(null),null===(n=ee.current)||void 0===n||null===(s=n.abort)||void 0===s||s.call(n),ee.current=new AbortController,i=ee.current.signal,ne.current=t?[C()(C()({},t),{},{uid:r.current})]:[],X.current="",u((function(e){return[].concat(P()(e),P()(ne.current))})),l=[{role:O.G7.System,content:w}].concat(P()(c),P()(ne.current)),o=(0,O.kA)(l),d=C()(C()({messages:o},v),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=17,(0,A.U3)({data:d,url:N.qt,signal:i});case 17:if(null==(f=e.sent)||!f.error){e.next=21;break}return B({error:!0,errorMessage:(null==f||null===(m=f.data)||void 0===m||null===(m=m.error)||void 0===m?void 0:m.message)||(null==f||null===(p=f.data)||void 0===p?void 0:p.message)||""}),e.abrupt("return");case 21:return ue(),h=f.reader,g=f.decoder,e.next=25,(0,A.LN)(h,g,(function(e){var t;null!=e&&e.error?B({error:!0,errorMessage:(null==e||null===(t=e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||""}):fe(e)}));case 25:e.next=29;break;case 27:e.prev=27,e.t0=e.catch(2);case 29:return e.prev=29,q(!1),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[2,27,29,32]])})));return function(t){return e.apply(this,arguments)}}();return(0,S.useEffect)((function(){te.current&&ie(te.current)}),[te.current,ie]),(0,S.useEffect)((function(){re.current&&oe(re.current)}),[re.current,oe]),(0,S.useEffect)((function(){D&&le()}),[c,D]),(0,S.useEffect)((function(){c.length>ae.current&&le(),ae.current=c.length}),[c.length]),(0,W.jsxs)("div",{className:"ground-left-wrapper",children:[(0,W.jsxs)("div",{className:"ground-left",children:[(0,W.jsx)("div",{className:"message-list-wrap",ref:te,children:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{style:{marginBottom:20},children:(0,W.jsx)(Q,{style:{borderRadius:"var(--border-radius-mini)",overflow:"hidden"},systemMessage:w,setSystemMessage:k})}),(0,W.jsxs)("div",{className:"content",children:[(0,W.jsx)(H,{messageList:c,setMessageList:u,editable:!0,loading:D}),D&&(0,W.jsx)(E.Z,{size:"small",children:(0,W.jsx)("div",{style:{height:"46px"}})})]})]})}),U&&(0,W.jsx)("div",{style:{height:40},children:(0,W.jsx)(pe,{usage:U})}),(0,W.jsx)("div",{className:"ground-left-footer",children:(0,W.jsx)(z.Z,{defaultSize:{minRows:5,maxRows:5},loading:D,disabled:!v.model,isEmpty:!c.length,handleSubmit:function(e){var t,n=e.content||null!==(t=e.imgs)&&void 0!==t&&t.length?e:void 0;me(n)},addMessage:function(e){var t,n=e||{role:(null===(t=Z().last(c))||void 0===t?void 0:t.role)===O.G7.User?O.G7.Assistant:O.G7.User,content:""};c.push(C()(C()({},n),{},{uid:r.current+1})),ue(),u(P()(c))},handleAbortFetch:function(){var e,t;null===(e=ee.current)||void 0===e||null===(t=e.abort)||void 0===t||t.call(e),q(!1)},clearAll:function(){c.length&&(ue(),u([]),B(null))},setModelSelections:function(){},presetPrompt:function(e){var t,n=e.filter((function(e){return"system"===e.role})),a=e.filter((function(e){return"user"===e.role})).map((function(e){return ue(),C()(C()({},e),{},{uid:r.current})}));k((null===(t=n[0])||void 0===t?void 0:t.content)||""),u(a)}})})]}),(0,W.jsx)("div",{className:j()("params-wrapper",{collapsed:K}),ref:re,children:(0,W.jsx)("div",{className:"box",children:(0,W.jsx)(de,{setParams:x,params:v,selectedModel:m,modelList:n})})}),(0,W.jsx)(he.Z,C()(C()({},O.NW.chat),{},{open:R,payload:{messages:ce},parameters:v,onCancel:function(){I(!1)},title:d.formatMessage({id:"playground.viewcode"})}))]})})),ve=(0,S.memo)(ge),xe=S.createContext({}),ye=n(23010),be=function(e){var t=e.style,n=(0,g.useIntl)();(0,g.useNavigate)();return(0,W.jsx)("div",{className:"flex-center  justify-center",style:C()({},t),children:(0,W.jsx)(ye.Z,{image:ye.Z.PRESENTED_IMAGE_SIMPLE,description:(0,W.jsx)("div",{className:"flex-column",children:(0,W.jsx)(me.Z.Text,{type:"secondary",children:n.formatMessage({id:"playground.model.noavailable"})})})})})},we=n(81745),je=n(7922),ke=n(33883),Ze=n(51076),Se=n(69070),Me=n(1404),Ne=n(43211),Te=n(60857),Ce=n(8964),Re=n(40918),Pe=(0,S.forwardRef)((function(e,t){var n=e.model,r=e.modelList,s=e.instanceId,l=(0,S.useContext)(xe),u=l.globalParams,d=l.setGlobalParams,f=l.setLoadingStatus,m=l.handleDeleteModel,p=l.handleApplySystemChangeToAll,h=l.modelFullList,v=l.loadingStatus,y=(0,g.useIntl)(),b=(0,S.useRef)(!1),w=(0,S.useState)(""),j=o()(w,2),k=j[0],M=j[1],T=(0,S.useState)({model:n}),R=o()(T,2),z=R[0],I=R[1],L=(0,S.useState)(!1),F=o()(L,2),D=F[0],q=(F[1],(0,S.useRef)(0)),G=(0,S.useState)([]),V=o()(G,2),U=V[0],B=V[1],J=(0,S.useState)(null),K=o()(J,2),$=K[0],X=K[1],ee=(0,S.useState)(!1),te=o()(ee,2),ne=te[0],re=te[1],ae=(0,S.useRef)(""),se=(0,S.useRef)(null),ie=(0,S.useRef)([]),le=(0,S.useRef)(null),oe=(0,S.useRef)(0),ce=(0,_.Z)(),ue=ce.initialize,fe=ce.updateScrollerPosition,me=(0,S.useMemo)((function(){return(0,O.kA)([{role:O.G7.System,content:k}].concat(P()(U)))}),[U,k]),ge=function(){q.current=q.current+1},ve=function(){var e,t;null===(e=se.current)||void 0===e||null===(t=e.abort)||void 0===t||t.call(e),f(s,!1)},ye=function(e){var t;X(C()({},null!==(t=null==e?void 0:e.usage)&&void 0!==t?t:{})),e&&Z().get(e,"choices",[].length)&&(ae.current=ae.current+Z().get(e,"choices.0.delta.content",""),B([].concat(P()(U),P()(ie.current),[{role:O.G7.Assistant,content:ae.current,uid:q.current}])))},be=function(){var e=i()(a()().mark((function e(t){var n,r,i,l,o,c,u,d,m,p,h;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,f(s,!0),ge(),null===(n=se.current)||void 0===n||null===(r=n.abort)||void 0===r||r.call(n),se.current=new AbortController,i=se.current.signal,ie.current=t?[C()(C()({},t),{},{uid:q.current})]:[],B((function(e){return[].concat(P()(e),P()(ie.current))})),ae.current="",l=[{role:O.G7.System,content:k}].concat(P()(U),P()(ie.current)),o=(0,O.kA)(l),c=C()(C()({messages:o},z),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=16,(0,A.U3)({data:c,url:N.qt,signal:i});case 16:if(null==(u=e.sent)||!u.error){e.next=20;break}return X({error:!0,errorMessage:(null==u||null===(d=u.data)||void 0===d||null===(d=d.error)||void 0===d?void 0:d.message)||(null==u||null===(m=u.data)||void 0===m?void 0:m.message)||""}),e.abrupt("return");case 20:return ge(),p=u.reader,h=u.decoder,e.next=24,(0,A.LN)(p,h,(function(e){var t;null!=e&&e.error?X({error:!0,errorMessage:(null==e||null===(t=e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||""}):ye(e)}));case 24:e.next=28;break;case 26:e.prev=26,e.t0=e.catch(2);case 28:return e.prev=28,f(s,!1),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[2,26,28,31]])})));return function(t){return e.apply(this,arguments)}}(),we=function(e){var t,n=e.content||null!==(t=e.imgs)&&void 0!==t&&t.length?e:void 0;be(n)},je=(0,S.useCallback)((function(e,t){b.current?(I(C()(C()({},z),t)),d(C()({},t))):I(C()(C()({},z),e))}),[z,b.current]),Pe=function(){B([]),X(null),ie.current=[]},_e=function(e){ge(),B((function(t){return[].concat(P()(t),[C()(C()({},e),{},{uid:q.current})])}))},Ae=function(e){ie.current=[];var t=Z().map(e,(function(e){return ge(),{role:e.role,content:e.content,uid:q.current}}));X(null),B(t)},Ee=((0,S.useMemo)((function(){return h.filter((function(e){return"empty"!==e.type}))}),[h]),(0,S.useMemo)((function(){var e=[{label:y.formatMessage({id:"common.button.clear"}),key:"clear",icon:(0,W.jsx)(Ze.Z,{}),danger:!1,onClick:function(){B([]),M("")}},{label:y.formatMessage({id:"playground.viewcode"}),key:"viewcode",icon:(0,W.jsx)(c.Z,{type:"icon-code"}),onClick:function(){re(!0)}}];return r.length>2&&e.push({label:y.formatMessage({id:"common.button.delete"}),key:"delete",icon:(0,W.jsx)(Se.Z,{}),danger:!0,onClick:function(){m(s)}}),e}),[r,y]));return(0,S.useEffect)((function(){I(C()(C()({},z),u))}),[u]),(0,S.useEffect)((function(){return function(){ve()}}),[]),(0,S.useEffect)((function(){le.current&&ue(le.current)}),[le.current,ue]),(0,S.useEffect)((function(){v[s]&&fe()}),[U]),(0,S.useEffect)((function(){U.length>oe.current&&fe(),oe.current=U.length}),[U.length]),(0,S.useImperativeHandle)(t,(function(){return{submit:we,abortFetch:ve,addNewMessage:_e,clear:Pe,presetPrompt:Ae,setSystemMessage:M,loading:D}})),(0,W.jsxs)("div",{className:"model-item",children:[(0,W.jsxs)("div",{className:"header",children:[(0,W.jsx)("span",{className:"title",children:(0,W.jsx)(Te.default,{style:{width:"100%"},variant:"borderless",options:h,onChange:function(e){I(C()(C()({},z),{},{model:e})),Pe()},value:z.model,labelRender:function(e){return(0,W.jsx)(ke.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})},optionRender:function(e){return(0,W.jsx)(ke.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})}})}),(0,W.jsx)(pe,{usage:$,scaleable:!0}),(0,W.jsxs)("span",{className:"action",children:[(0,W.jsx)(Ce.Z,{menu:{items:Ee},placement:"bottomRight",children:(0,W.jsx)(x.ZP,{type:"text",icon:(0,W.jsx)(Me.Z,{style:{fontSize:"14px"}}),size:"small"})}),(0,W.jsx)(Re.Z,{placement:"bottomRight",content:(0,W.jsx)(de,{showModelSelector:!1,setParams:I,modelList:r,globalParams:u,selectedModel:z.model,onValuesChange:je}),trigger:["click"],arrow:!1,fresh:!0,title:(0,W.jsx)("div",{children:(0,W.jsx)(Y.Z,{onChange:function(e){b.current=e.target.checked,e.target.checked&&d(C()({},Z().omit(z,"model")))},children:y.formatMessage({id:"playground.compare.applytoall"})})}),children:(0,W.jsx)(x.ZP,{type:"text",icon:(0,W.jsx)(Ne.Z,{}),size:"small"})})]})]}),(0,W.jsx)(Q,{showApplyToAll:!0,systemMessage:k,applyToAll:p,setSystemMessage:M}),(0,W.jsx)("div",{className:"content",ref:le,children:(0,W.jsxs)("div",{children:[(0,W.jsx)(H,{messageList:U,setMessageList:B,editable:!0}),(0,W.jsx)(E.Z,{spinning:!!v[s],size:"small",style:{width:"100%"}})]})}),(0,W.jsx)(he.Z,C()(C()({},O.NW.chat),{},{open:ne,payload:{messages:me},parameters:z,onCancel:function(){re(!1)},title:y.formatMessage({id:"playground.viewcode"})}))]})})),_e=S.memo(Pe),Ae=function(e){var t=e.spans,n=e.modelSelections,r=e.setModelRefs;return(0,W.jsx)(we.Z,{gutter:[16,0],style:{height:"100%"},children:n.map((function(e,a){return(0,W.jsx)(je.Z,{span:t.span,style:{height:t.count<4?"calc(100% - 16px)":"calc(50% - 16px)"},children:(0,W.jsx)(_e,{ref:function(t){return r(e.instanceId,t)},instanceId:e.instanceId,modelList:n,model:e.value},"".concat(e.value||"empty","-").concat(e.uid))},"".concat(e.value||"empty","-").concat(e.uid))}))})},Ee=S.memo(Ae),Oe=function(e){var t=e.modelList,n=e.loaded,r=(0,_.Z)().initialize,s=(0,S.useState)({}),l=o()(s,2),c=l[0],u=l[1],d=(0,S.useState)([]),f=o()(d,2),m=f[0],p=f[1],h=(0,S.useState)({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024}),g=o()(h,2),v=g[0],x=g[1],y=(0,S.useState)({span:12,count:2}),b=o()(y,2),w=b[0],j=b[1],k=(0,S.useRef)({}),M=(0,S.useRef)({}),N=(0,S.useRef)(null),T=(0,S.useMemo)((function(){return Object.getOwnPropertySymbols(c).some((function(e){return c[e]}))}),[c]),R=((0,S.useMemo)((function(){return t.map((function(e){return C()(C()({},e),{},{disabled:m.some((function(t){return t.value===e.value}))})}))}),[t,m]),function(e){return k.current[e]=Z().add(k.current[e],1),k.current[e]}),P=(0,S.useCallback)((function(e,t){M.current[e]=t}),[]);return(0,S.useEffect)((function(){M.current={};var e=Z().take(t,w.count);if(e.length<w.count&&e.length>0){var n=w.count-e.length,r=Array.from({length:n},(function(e,t){return{label:"",value:"",type:"empty"}}));e=Z().concat(e,r)}var a=e.map((function(e){return C()(C()({},e),{},{uid:R(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));p(a)}),[t]),(0,S.useEffect)((function(){N.current&&r(N.current)}),[N.current,r]),(0,W.jsxs)("div",{className:"multiple-chat",style:{height:"calc(100vh - 72px)"},children:[(0,W.jsx)("div",{className:"chat-list",ref:N,children:t.length>0?(0,W.jsx)(xe.Provider,{value:{spans:w,globalParams:v,loadingStatus:c,modelFullList:t,handleApplySystemChangeToAll:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(t){var n=M.current[t];null==n||n.setSystemMessage(e)}))},setGlobalParams:x,setLoadingStatus:function(e,t){u((function(n){var r=C()({},n);return r[e]=t,r}))},handleDeleteModel:function(e){var t,n=m.filter((function(t){return t.instanceId!==e}));!function(e){M.current[e]=null,c[e]=!1}(e),t=w.count-1,6===w.count?j({span:8,count:t}):5===w.count?j({span:12,count:t}):4===w.count?j({span:8,count:t}):3===w.count&&j({span:12,count:t}),p(n)}},children:(0,W.jsx)(Ee,{spans:w,modelSelections:m,setModelRefs:P})}):n&&(0,W.jsx)(be,{style:{height:"100%",paddingBottom:60}})}),(0,W.jsx)("div",{children:(0,W.jsx)(z.Z,{loading:T,disabled:T||!m.length||!t.length,handleSubmit:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(t){var n=M.current[t];null==n||n.submit(e)}))},addMessage:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(t){var n=M.current[t];null==n||n.addNewMessage(e)}))},handleAbortFetch:function(){Object.getOwnPropertySymbols(M.current).forEach((function(e){var t=M.current[e];null==t||t.abortFetch()}))},clearAll:function(){Object.getOwnPropertySymbols(M.current).forEach((function(e){var t=M.current[e];null==t||t.clear()}))},updateLayout:function(e){j(e),function(e){var n=m;if(n.length<e.count){var r=e.count-n.length,a=Z().slice(t,n.length,n.length+r),s=Array.from({length:r-a.length},(function(e,t){return{label:"",value:"",type:"empty"}})),i=Z().concat(a,s).map((function(e){return C()(C()({},e),{},{uid:R(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));p(Z().concat(n,i))}else if(n.length>e.count){var l=n.slice(0,e.count);p(l)}}(e)},setModelSelections:function(e){var t=e.map((function(e){return C()(C()({},e),{},{uid:R(e.value),instanceId:Symbol(e.value)})})),n=Z().concat(m,t),r=Math.floor(24/n.length);j({span:r<8?8:r,count:w.count}),p(n)},presetPrompt:function(e){var t=e.filter((function(e){return"system"===e.role})),n=e.filter((function(e){return"user"===e.role}));Object.getOwnPropertySymbols(M.current).forEach(function(){var e=i()(a()().mark((function e(r){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(s=M.current[r])||s.presetPrompt(n),null==s||s.setSystemMessage(Z().get(t,"0.content",""));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},defaultSize:{minRows:5,maxRows:5}})})]})},ze=(0,S.memo)(Oe),Ie=(n(20988),function(){var e=(0,g.useIntl)(),t=(0,f.Z)().size,n=(0,S.useState)("chat"),r=o()(n,2),s=r[0],l=r[1],w=(0,S.useRef)(null),k=(0,S.useRef)(null),T=(0,S.useState)([]),C=o()(T,2),R=C[0],P=C[1],_=(0,S.useState)(!1),A=o()(_,2),E=A[0],O=A[1],z=[{label:e.formatMessage({id:"menu.playground.chat"}),value:"chat",icon:(0,W.jsx)(m.Z,{})},{label:e.formatMessage({id:"menu.compare"}),value:"compare",icon:(0,W.jsx)(p.Z,{})}],I=(0,S.useCallback)((function(){var e,t;if("reranker"===s)null===(e=k.current)||void 0===e||null===(t=e.viewCode)||void 0===t||t.call(e);else if("chat"===s){var n,r;null===(n=w.current)||void 0===n||null===(r=n.viewCode)||void 0===r||r.call(n)}}),[w,k,s]),L=(0,S.useCallback)((function(){var e,t,n,r;"reranker"!==s?null===(e=w.current)||void 0===e||null===(t=e.setCollapse)||void 0===t||t.call(e):null===(n=k.current)||void 0===n||null===(r=n.setCollapse)||void 0===r||r.call(n)}),[w,k,s]),F=[{key:"chat",label:"Chat",children:(0,W.jsx)(ve,{ref:w,modelList:R})},{key:"compare",label:"Compare",children:(0,W.jsx)(ze,{modelList:R,loaded:E})}];(0,S.useEffect)((function(){var e,n,r;t.width<u.Z.lg&&(null!==(e=w.current)&&void 0!==e&&e.collapse||null===(n=w.current)||void 0===n||null===(r=n.setCollapse)||void 0===r||r.call(n))}),[t.width]),(0,S.useEffect)((function(){var e=function(){var e=i()(a()().mark((function e(){var t,n,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={embedding_only:!1,image_only:!1,reranker:!1,text_to_speech:!1,speech_to_text:!1},e.next=4,(0,N.nb)(t);case 4:return n=e.sent,r=Z().map(n.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=i()(a()().mark((function t(){var n;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:n=t.sent,P(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),O(!0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[]);return(0,M.y1)(d.ZP.RIGHT.join(","),(function(){var e,t;null===(e=w.current)||void 0===e||null===(t=e.setCollapse)||void 0===t||t.call(e)}),{preventDefault:!0}),(0,W.jsx)(h._z,{ghost:!0,header:{title:(0,W.jsxs)("div",{className:"flex items-center",children:[(0,W.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.chat"})}),(0,W.jsx)(y.Z,{options:z,size:"middle",className:"m-l-40",onChange:function(e){return l(e)}})]}),breadcrumb:{}},extra:"compare"!==s&&(0,W.jsxs)(v.Z,{children:[(0,W.jsx)(x.ZP,{size:"middle",onClick:I,icon:(0,W.jsx)(c.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,W.jsx)(x.ZP,{size:"middle",onClick:L,icon:(0,W.jsx)(c.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:j()("playground-container",{compare:"compare"===s,chat:"compare"!==s}),children:(0,W.jsx)("div",{className:"play-ground",children:(0,W.jsx)("div",{className:"chat",children:(0,W.jsx)(b.Z,{items:F,activeKey:s})})})})})},81117:function(e,t,n){n.d(t,{LN:function(){return h},U3:function(){return p},YT:function(){return v}});var r=n(335),a=n.n(r),s=n(90228),i=n.n(s),l=n(26068),o=n.n(l),c=n(87999),u=n.n(c),d=n(55360),f=/data:\s*({.*?})(?=\n|$)/g,m=function(e){var t,n=[];if(!e)return n;for(;null!==(t=f.exec(e));)try{var r=JSON.parse(t[1]);n.push(r)}catch(e){continue}return n},p=function(){var e=u()(i()().mark((function e(t){var n,r,a,s,l,c;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.method||"POST",a=t.url,t.params&&(a="".concat(a,"?").concat(d.Z.stringify(t.params))),e.next=5,fetch(a,{method:r,body:"POST"===r?JSON.stringify(t.data):null,signal:t.signal,headers:o()({"Content-Type":"application/json"},t.headers)});case 5:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.json();case 10:return e.t0=e.sent,e.abrupt("return",{error:!0,data:e.t0});case 12:return l=null==s||null===(n=s.body)||void 0===n?void 0:n.getReader(),c=new TextDecoder("utf-8",{fatal:!0}),e.abrupt("return",{reader:l,decoder:c});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=u()(i()().mark((function e(t,n,r){var a,s,l,o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.read();case 2:if(a=e.sent,s=a.done,l=a.value,!s){e.next=7;break}return e.abrupt("return");case 7:return o=n.decode(l,{stream:!0}),m(o).forEach((function(e){null==r||r(e)})),e.next=11,h(t,n,r);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),g=function(e,t){var n,r=e.split("\n"),s=a()(r);try{for(s.s();!(n=s.n()).done;){var i=n.value;if(i.startsWith("data: ")){var l=i.slice(6).trim();try{t(JSON.parse(l))}catch(e){}}}}catch(e){s.e(e)}finally{s.f()}},v=function(){var e=u()(i()().mark((function e(t,n,r){var s,l,o,c,u,d,f,m,p,h,v;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s="";case 1:return e.next=4,null==t||null===(l=t.read)||void 0===l?void 0:l.call(t);case 4:if(o=e.sent,c=o.done,u=o.value,!c){e.next=10;break}return s.trim()&&g(s,r),e.abrupt("break",17);case 10:s+=n.decode(u,{stream:!0}),d=s.split("\n"),s=d.pop()||"",f=a()(d);try{for(f.s();!(m=f.n()).done;)if((p=m.value).startsWith("data: ")){h=p.slice(6).trim();try{"[DONE]"!==h&&(v=JSON.parse(h),r(v))}catch(e){}}}catch(e){f.e(e)}finally{f.f()}e.next=1;break;case 17:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},26938:function(e,t){t.Z={label:"label___Im6e1"}},51662:function(){},20988:function(){}}]);