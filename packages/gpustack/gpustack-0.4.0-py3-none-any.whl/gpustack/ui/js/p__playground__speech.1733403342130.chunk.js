"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8394],{1523:function(e,n,t){t.d(n,{q:function(){return a}});var r={documentation:"https://docs.gpustack.ai/",github:"https://github.com/gpustack/gpustack",discord:"https://discord.gg/VXYJzuaqwD",site:"https://gpustack.ai/",release:"https://github.com/gpustack/gpustack/releases"};n.Z=r;var a={audioPermission:"".concat(r.documentation,"latest/user-guide/playground/audio/#provide-audio-file")}},68940:function(e,n,t){t.d(n,{U:function(){return i},Z:function(){return l}});var r=t(9532),a=t(50959);function l(){return r.Z.CancelToken.source}function i(){var e=r.Z.CancelToken.source,n=(0,a.useRef)(null);return(0,a.useEffect)((function(){return function(){n.current&&n.current.cancel()}}),[]),{updateCancelToken:function(){n.current&&n.current.cancel(),n.current=e()},cancelRequest:function(){n.current&&n.current.cancel()},getCanceltToken:function(){return n.current.token},source:e}}},22471:function(e,n,t){t.d(n,{Ci:function(){return o},FM:function(){return l},GF:function(){return u},I_:function(){return r},JY:function(){return a},QU:function(){return i}});var r=[{type:"Select",name:"voice",options:[],label:{text:"playground.params.voice",isLocalized:!0},rules:[{required:!0,message:"Voice is required"}]},{type:"Select",name:"response_format",options:[{label:"mp3",value:"mp3"},{label:"wav",value:"wav"}],label:{text:"playground.params.format",isLocalized:!0},rules:[{required:!1}]}],a=[{type:"Select",name:"language",options:[{label:"Auto",value:"auto"},{label:"English",value:"en"},{label:"中文",value:"zh"},{label:"日本語",value:"ja"},{label:"Français",value:"fr"},{label:"Deutsch",value:"de"}],label:{text:"playground.params.language",isLocalized:!0},rules:[{required:!0}]}],l=[{type:"InputNumber",name:"n",label:{text:"playground.params.counts",isLocalized:!0},attrs:{min:1,max:4},rules:[{required:!1}]},{type:"Select",name:"size",options:[{label:"playground.params.custom",value:"custom",locale:!0},{label:"256x256",value:"256x256"},{label:"512x512",value:"512x512"},{label:"1024x1024",value:"1024x1024"}],description:{text:"playground.params.size.description",html:!0,isLocalized:!0},label:{text:"playground.params.size",isLocalized:!0},rules:[{required:!1}]}],i=[{type:"Select",name:"quality",options:[{label:"playground.params.standard",value:"standard",locale:!0},{label:"playground.params.hd",value:"hd",locale:!0}],label:{text:"playground.params.quality",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"style",options:[{label:"playground.params.style.vivid",value:"vivid",locale:!0},{label:"playground.params.style.natural",value:"natural",locale:!0}],attrs:{allowClear:!0},label:{text:"playground.params.style",isLocalized:!0},rules:[{required:!1}]}],u=[{type:"Select",name:"sampler",options:[{label:"euler_a",value:"euler_a"},{label:"euler",value:"euler"},{label:"heun",value:"heun"},{label:"dpm2",value:"dpm2"},{label:"dpm++2s_a",value:"dpm++2s_a"},{label:"dpm++2m",value:"dpm++2m"},{label:"dpm++2mv2",value:"dpm++2mv2"},{label:"ipndm",value:"ipndm"},{label:"ipndm_v",value:"ipndm_v"},{label:"lcm",value:"lcm"}],label:{text:"playground.image.params.sampler",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"schedule",options:[{label:"discrete",value:"discrete"},{label:"karras",value:"karras"},{label:"exponential",value:"exponential"},{label:"ays",value:"ays"},{label:"gits",value:"gits"}],label:{text:"playground.image.params.schedule",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"sample_steps",label:{text:"playground.image.params.samplerSteps",isLocalized:!0},attrs:{min:1,max:100},rules:[{required:!1}]},{type:"InputNumber",name:"cfg_scale",label:{text:"CFG Scale",isLocalized:!1},attrs:{min:1,max:10,step:.1},rules:[{required:!1}]},{type:"Input",name:"negative_prompt",label:{text:"playground.image.params.negativePrompt",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"seed",label:{text:"playground.image.params.seed",isLocalized:!0},attrs:{min:0},disabledConfig:{depends:["random_seed"],when:function(e){return null==e?void 0:e.random_seed}},rules:[{required:!1}]},{type:"Checkbox",name:"random_seed",label:{text:"playground.image.params.randomseed",isLocalized:!0},rules:[{required:!1}]}],o=[{type:"Slider",name:"width",label:{text:"playground.params.width",isLocalized:!0},attrs:{min:256,max:3200,step:64,inputnumber:!1},rules:[{required:!0,message:"playground.params.width"}]},{type:"Slider",name:"height",label:{text:"playground.params.height",isLocalized:!0},attrs:{min:256,max:3200,step:64,inputnumber:!1},rules:[{required:!0,message:"playground.params.height"}]}]},18468:function(e,n,t){t.r(n),t.d(n,{default:function(){return en}});var r=t(90228),a=t.n(r),l=t(87999),i=t.n(l),u=t(48305),o=t.n(u),s=t(83057),c=t(35445),d=t(93495),p=t(55592),f=t(6555),v=t(55169),m=t(99178),h=t(54235),g=t(85885),x=t(96938),y=t(47946),b=t(82187),j=t.n(b),w=t(32699),k=t.n(w),C=t(50959),R=t(94299),S=t(35014),M=t(26068),Z=t.n(M),_=t(49662),N=function(e){var n=(0,C.useState)({width:0,height:0}),t=o()(n,2),r=t[0],a=t[1];return(0,C.useEffect)((function(){var n=e.current;if(n){var t=new ResizeObserver((function(e){if(e[0]){var n=e[0].contentRect,t=n.width,r=n.height;a({width:t,height:r})}}));return t.observe(n),function(){t.disconnect()}}}),[e]),r},z=t(11527),A=function(e){var n=e.scaleFactor,t=void 0===n?1.2:n,r=e.maxBarCount,a=void 0===r?128:r,l=e.amplitude,i=void 0===l?40:l,u=e.maxWidth,s=e.fixedHeight,c=void 0===s||s,d=e.analyserData,p=e.width,f=e.height,v=C.useRef(null),m=C.useRef(0),h=C.useRef(!1),g=C.useRef(0),x=C.useRef(1),y=C.useRef(null),b=(0,C.useState)(p),j=o()(b,2),w=j[0],k=j[1],R=(0,C.useState)(f),S=o()(R,2),M=S[0],Z=S[1],_=C.useRef(null),A=N(y),P=function(e,n,t,r,l){return r+(.5*Math.sin(n/200+e)+.5)*(l-r)*(t/a)};return C.useEffect((function(){A&&(k(u?Math.min(A.width,u):(null==A?void 0:A.width)||0),c||Z((null==A?void 0:A.height)||0))}),[A,u]),(0,C.useEffect)((function(){var e,n;if(v.current){var r=function(){if(v.current){var e=v.current.getContext("2d");e&&e.clearRect(0,0,2*w,2*M)}};return null!==(e=d.data)&&void 0!==e&&e.length&&null!==(n=d.analyser)&&void 0!==n&&n.current?(function(){var e;if(v.current&&null!==(e=d.data)&&void 0!==e&&e.length){var n=v.current,r=n.getContext("2d");if(r){var l=n.width=2*w,u=n.height=2*M;h.current||(r.scale(2,2),h.current=!0);var o=Math.floor(u/2),s=i,c=0,p=r.createLinearGradient(0,0,0,u);p.addColorStop(0,"#007BFF"),p.addColorStop(1,"#0069DA"),r.fillStyle=p,function e(n){var i;if(n-c<16)m.current=requestAnimationFrame(e);else{c=n,null===(i=d.analyser)||void 0===i||null===(i=i.current)||void 0===i||i.getByteFrequencyData(d.data),r.clearRect(0,0,l,u);var p=Math.min(a,d.data.length),f=l/2-(10*p-6)/2+g.current;g.current+=x.current,Math.abs(g.current)>20&&(x.current*=-1);for(var v=0;v<p;v++){var h=Math.floor(d.data[v]/2)*t,y=P(v,n,h,10,s),b=h+Math.round(y),j=Math.round(o-b/2),w=Math.round(o+b/2);r.beginPath(),r.moveTo(f,w),r.lineTo(f,j+2),r.arcTo(f+4,j+2,f+4,w,2),r.lineTo(f+4,w),r.closePath(),r.fill(),f+=10}m.current=requestAnimationFrame(e)}}(performance.now())}}}(),function(){cancelAnimationFrame(m.current),r()}):(r(),cancelAnimationFrame(m.current),void(m.current=0))}}),[d,w,M]),(0,z.jsx)("div",{className:"scroller-wrapper",ref:y,style:{width:"100%",height:"100%"},children:(0,z.jsx)("div",{ref:_,className:"canvas-wrap",style:{width:"100%",height:"100%"},children:(0,z.jsx)("canvas",{ref:v,style:{display:"block"}})})})},P=C.memo(A),I=t(71239),L=t(48640),T=t(57859),U=t(95547),q=t(69324),E=t(96247),F=t(23333),O=.5,D=2,Y=.25,B=(0,C.forwardRef)((function(e,n){var t=(0,m.useIntl)(),r=e.autoplay,a=void 0!==r&&r,l=e.speed,i=void 0===l?1:l,u=C.useRef(null),s=C.useState({currentTime:0,duration:0}),c=o()(s,2),d=c[0],p=c[1],f=C.useState(!1),v=o()(f,2),h=v[0],x=v[1],y=C.useState(!1),b=o()(y,2),j=b[0],k=b[1],R=C.useState(1),S=o()(R,2),M=S[0],Z=S[1],_=C.useState(i),N=o()(_,2),A=N[0],P=N[1],B=C.useRef(null);(0,C.useImperativeHandle)(n,(function(){return{play:function(){var e;null===(e=u.current)||void 0===e||e.play()},pause:function(){var e;null===(e=u.current)||void 0===e||e.pause()}}}));(0,C.useCallback)((function(){k(!j)}),[j]),(0,C.useCallback)((function(e){P(e),u.current.playbackRate=e}),[]);var H=(0,C.useCallback)((function(){B.current=setInterval((function(){var e,n;p((function(e){var n,t;return{currentTime:Math.ceil((null===(n=u.current)||void 0===n?void 0:n.currentTime)||0),duration:e.duration||Math.ceil((null===(t=u.current)||void 0===t?void 0:t.duration)||0)}})),(null!==(e=u.current)&&void 0!==e&&e.paused||null!==(n=u.current)&&void 0!==n&&n.ended)&&(clearInterval(B.current),x(!1),p((function(e){var n;return{currentTime:null!==(n=u.current)&&void 0!==n&&n.ended?0:e.currentTime,duration:e.duration}})))}),500)}),[]),K=(0,C.useCallback)((function(){var e,n;(x(!h),h)?null===(e=u.current)||void 0===e||e.pause():null===(n=u.current)||void 0===n||n.play()}),[h]),G=((0,C.useCallback)((function(e){u.current.volume=(0,w.round)(e,2),Z((0,w.round)(e,2))}),[]),(0,C.useCallback)((function(n){var t,r=Math.ceil((null===(t=u.current)||void 0===t?void 0:t.duration)||0);p({currentTime:0,duration:r&&r!==1/0?r:e.duration||0}),x(a)}),[a,e.duration])),V=(0,C.useCallback)((function(e){u.current.currentTime=e,p((function(n){return{currentTime:e,duration:n.duration}}))}),[]);return(0,C.useEffect)((function(){u.current&&u.current&&(u.current.volume=M,u.current.playbackRate=A)}),[u.current]),(0,C.useEffect)((function(){return function(){clearInterval(B.current)}}),[]),(0,z.jsxs)("div",{className:"player-wrap",style:{width:e.width||"100%"},children:[(0,z.jsx)("div",{className:"player-ui",children:(0,z.jsx)("div",{className:"play-content",children:(0,z.jsxs)("div",{className:"progress-bar",children:[(0,z.jsx)("span",{className:"file-name",children:e.name}),(0,z.jsxs)("div",{className:"slider",children:[(0,z.jsxs)("span",{className:"time current",children:[" ",(0,I.mr)(d.currentTime)]}),(0,z.jsx)("div",{className:"slider-inner",children:(0,z.jsx)(E.Z,{tooltip:{open:!1},min:0,step:1,max:d.duration,value:d.currentTime,onChange:V})}),(0,z.jsx)("span",{className:"time",children:(0,I.mr)(d.duration)})]}),(0,z.jsxs)("div",{className:"controls",children:[(0,z.jsx)(F.Z,{title:t.formatMessage({id:"playground.audio.button.slow"}),children:(0,z.jsx)(g.ZP,{type:"text",size:"small",className:"backward",disabled:A===O||A<O,onClick:function(){P((function(e){if(e-Y<O)return O;var n=e-Y;return u.current.playbackRate=n,n}))},children:(0,z.jsx)(L.Z,{className:"font-size-20"})})}),(0,z.jsx)("span",{className:"play-btn",children:(0,z.jsx)(g.ZP,{size:"middle",type:"text",onClick:K,disabled:!(null!=d&&d.duration),icon:h?(0,z.jsx)(U.Z,{style:{fontSize:"22px"}}):(0,z.jsx)(T.Z,{style:{fontSize:"22px"}})})}),(0,z.jsx)(F.Z,{title:t.formatMessage({id:"playground.audio.button.fast"}),children:(0,z.jsx)(g.ZP,{type:"text",size:"small",className:"forward",disabled:A===D||A>D,onClick:function(){P((function(e){if(e+Y>D)return D;var n=e+Y;return u.current.playbackRate=n,n}))},children:(0,z.jsx)(q.Z,{className:"font-size-20"})})})]})]})})}),(0,z.jsx)("audio",{crossOrigin:"anonymous",autoPlay:a,src:e.url,ref:u,preload:"metadata",style:{opacity:0,position:"absolute",left:"-9999px"},onPlay:H,onLoadedMetadata:G})]})})),H=C.memo(B),K=t(42034),G=t(89234),V=t(30898),J=function(e){var n,t=(0,m.useIntl)(),r=C.useCallback((function(n){var t;null===(t=e.onChange)||void 0===t||t.call(e,n)}),[]);return(0,z.jsx)(F.Z,{overlayInnerStyle:{maxWidth:265,width:"max-content"},title:t.formatMessage({id:"playground.audio.uploadfile.tips"},{formats:e.accept}),children:(0,z.jsx)(V.Z,{beforeUpload:function(e){return!1},onChange:r,accept:e.accept,multiple:!1,maxCount:1,showUploadList:!1,fileList:[],children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,z.jsx)(g.ZP,{icon:(0,z.jsx)(G.Z,{}),type:null!==(n=e.type)&&void 0!==n?n:"text",shape:"circle"})})})})},W=C.memo(J),Q=t(571),$=t(68940),X=function(){var e=i()(a()().mark((function e(n,t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){try{var a=new Blob([n],{type:t}),l=(0,I.hy)(a.size),i=document.createElement("audio"),u=URL.createObjectURL(a);i.src=u,i.addEventListener("loadedmetadata",(function(){var n=i.duration;e({data:a,size:l,type:t,duration:Math.ceil(n),url:u})})),i.addEventListener("ended",(function(){URL.revokeObjectURL(i.src)}))}catch(e){r(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),ee=function(){var e=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var r=new FileReader;r.onload=function(){var r=i()(a()().mark((function r(l){var i,u;return a()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i=l.target.result,r.next=5,X(i,n.type);case 5:u=r.sent,e(Z()(Z()({},u||{}),{},{name:n.name})),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(0),t(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(e){return r.apply(this,arguments)}}(),r.onerror=function(e){return t(e)},r.readAsArrayBuffer(n)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ne=t(77353),te=t(54876),re=(t(72183),t(22471)),ae=(t(51662),t(21435),t(1523)),le=t(7672),ie=t.n(le),ue={"audio/mpeg":"mp3","audio/mp4":"mp4","audio/wav":"wav","audio/ogg":"ogg","audio/webm":"webm","audio/aac":"aac","audio/x-flac":"flac","audio/pcm":"pcm","audio/flac":"flac","audio/x-wav":"wav","audio/L16":"pcm","audio/opus":"opus"},oe={type:"audio/wav",suffix:".wav"},se=function(e){var n,t=(0,m.useIntl)(),r=(0,C.useState)(!1),l=o()(r,2),u=(l[0],l[1]),s=(0,C.useState)(!1),c=o()(s,2),d=c[0],p=c[1],v=(0,C.useState)(!0),x=o()(v,2),y=x[0],b=x[1],j=(0,C.useRef)(null),w=(0,C.useRef)(null),k=(0,C.useRef)(0),R=(0,C.useRef)(null),S=(0,C.useRef)(null),M=(0,C.useRef)(null),_=(0,C.useRef)(""),N=(0,C.useCallback)((function(){R.current=new(window.AudioContext||window.webkitAudioContext),S.current=R.current.createAnalyser(),S.current.fftSize=512,M.current=new Uint8Array(S.current.frequencyBinCount)}),[]),A=(0,C.useCallback)((function(){R.current.createMediaStreamSource(j.current).connect(S.current)}),[]),P=function(){var e;null===(e=j.current)||void 0===e||e.getTracks().forEach((function(e){e.stop()}))},I=function(){var e;p(!1),null===(e=w.current)||void 0===e||e.stop()},L=function(){var n=i()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,navigator.permissions.query({name:"microphone"});case 3:"granted"===(t=n.sent).state?(b(!0),e.onAudioPermission(!0)):"denied"===t.state&&(b(!1),e.onAudioPermission(!1),I()),t.onchange=function(){L()},n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}(),T=function(){var e=i()(a()().mark((function e(){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(n=navigator.mediaDevices)||void 0===n?void 0:n.getUserMedia({audio:!0});case 3:j.current=e.sent,j.current.getAudioTracks().forEach((function(e){e.onended=function(){b(!1)}})),u(!0),b(!0),N(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),U=function(e){var n,t=e||(null===(n=w.current)||void 0===n?void 0:n.mimeType),r=oe;return Object.keys(ue).forEach((function(e){t.includes(e)&&(r={type:t,suffix:".".concat(ue[e])})})),r},q=function(e){var n=U(e);return"recording-".concat(ie()().format("YYYY-MM-DD-HH_mm_ss")).concat(n.suffix)},E=function(){var n=i()(a()().mark((function n(){var t,r;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!d){n.next=3;break}return a=void 0,l=void 0,null===(a=w.current)||void 0===a||a.stop(),p(!1),null===(l=e.onRecord)||void 0===l||l.call(e,!1),n.abrupt("return");case 3:return n.prev=3,n.next=6,T();case 6:URL.revokeObjectURL(_.current),w.current=new MediaRecorder(j.current),r=[],w.current.ondataavailable=function(n){var t,a;(r.push(n.data),e.voiceActivity)&&(null===(t=S.current)||void 0===t||t.getByteFrequencyData(M.current),null===(a=e.onAnalyse)||void 0===a||a.call(e,M.current,S))},w.current.onstop=function(){U();var n,t,a,l=new Blob(r,{type:"audio/mpeg"});_.current=URL.createObjectURL(l),t={chunks:l,size:l.size,type:l.type,url:_.current,name:q(l.type),duration:Math.floor((Date.now()-k.current)/1e3)},null===(a=e.onAudioData)||void 0===a||a.call(e,t),null===(n=e.onAnalyse)||void 0===n||n.call(e,[],null)},p(!0),null===(t=e.onRecord)||void 0===t||t.call(e,!0),k.current=Date.now(),w.current.start(100),A(),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(3);case 22:case"end":return n.stop()}var a,l}),n,null,[[3,19]])})));return function(){return n.apply(this,arguments)}}(),O=(0,C.useMemo)((function(){return y?d?t.formatMessage({id:"playground.audio.stoprecord"}):t.formatMessage({id:"playground.audio.startrecord"}):(0,z.jsx)("span",{children:(0,z.jsxs)("span",{children:[t.formatMessage({id:"playground.audio.enablemic"}),(0,z.jsx)(g.ZP,{size:"small",color:"primary",variant:"link",href:"".concat(ae.q.audioPermission),target:"_blank",style:{color:"var(--ant-blue-5)"},children:t.formatMessage({id:"playground.audio.enablemic.doc"})})]})})}),[y,d,t]),D=(0,C.useMemo)((function(){return y?{}:{backgroundColor:"var(--ant-color-error-bg-filled-hover)",color:"var(--ant-color-error-border-hover)",border:"none"}}),[y]);return(0,C.useEffect)((function(){return function(){I(),P(),URL.revokeObjectURL(_.current)}}),[]),(0,C.useEffect)((function(){L()}),[]),(0,z.jsx)("div",{className:"audio-input",children:(0,z.jsx)(h.Z,{size:40,className:"btns",children:(0,z.jsx)(F.Z,{title:O,children:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,z.jsx)(g.ZP,{disabled:!y,shape:"circle",icon:(0,z.jsx)(f.Z,{}),size:"middle",type:null!==(n=e.type)&&void 0!==n?n:"text",style:Z()({},D),danger:d,onClick:E})})})})})},ce=C.memo(se),de=t(76483),pe=t(31759),fe=t.n(pe),ve=t(16850),me=t(16333),he=t(90515),ge=t(1956),xe="bash",ye="python",be="javascript",je=[{label:"Curl",value:xe},{label:"Python",value:ye},{label:"Nodejs",value:be}],we=function(e){var n=e||{},t=n.title,r=n.open,a=n.api,l=n.clientType,i=n.logcommand,u=n.onCancel,s=n.payload,c=n.parameters,d=void 0===c?{}:c,p=(0,m.useIntl)(),f=(0,C.useState)(xe),v=o()(f,2),h=v[0],x=v[1],y="".concat(window.location.origin,"/v1-openai"),b=(0,C.useMemo)((function(){i&&"print(response.".concat(i,")");if(h===xe)return"curl ".concat(window.location.origin,"/v1-openai/").concat(a,' \\\n-H "Content-Type: multipart/form-data" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-F file="@/path/to/file/audio.mp3;type=audio/mpeg" \\\n-F model="').concat(d.model,'" \\\n-F language="').concat(d.language,'"');if(h===be){var e=JSON.stringify(Z()(Z()(Z()({},d),s),{},{file:"fs.createReadStream(audio.mp3)"}),null,4).replace(/"fs.createReadStream\(audio.mp3\)"/g,'fs.createReadStream("audio.mp3")');return'const fs = require("fs")\nconst OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(y,'"\n});\n\nasync function main(){\n  const params = ').concat(e,";\nconst response = await openai.").concat(l,"(params);\n  ").concat("console.log(response.text);\n","}\nmain();")}if(h===ye){var n=k().keys(d).reduce((function(e,n){if(null===d[n])return e;var t="string"==typeof d[n]?'"'.concat(d[n],'"'):d[n];return e+"  ".concat(n,"=").concat(t,",\n")}),""),t=function(e){return k().keys(e).reduce((function(n,t){if(null===e[t])return n;var r="object"===fe()(e[t])?JSON.stringify(e[t],null,2):'"'.concat(e[t],'"');return n+"  ".concat(t,"=").concat(r,",\n")}),"  file=audio_file\n")}(s);return'from openai import OpenAI\n\naudio_file = open("audio.mp3", "rb")\nclient = OpenAI(\n  base_url="'.concat(y,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.').concat(l,"(\n").concat(n).concat(t,")\nprint('response:', response.text)")}return""}),[h,s,d,a,l,i]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(ge.Z,{title:t,open:r,centered:!0,onCancel:function(){x(xe),u()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,z.jsx)("div",{style:{marginBottom:"10px"},children:p.formatMessage({id:"playground.viewcode.info"})}),(0,z.jsxs)("div",{children:[(0,z.jsx)(ve.Z,{copyText:b,langOptions:je,defaultValue:xe,showHeader:!0,onChangeLang:function(e){x(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,z.jsx)("div",{style:{paddingRight:2,paddingBottom:2},children:(0,z.jsx)(me.Z,{height:380,theme:"dark",code:b,lang:h,copyable:!1})})}),(0,z.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,z.jsx)(he.Z,{className:"m-r-8"}),(0,z.jsx)("span",{children:p.formatMessage({id:"playground.viewcode.tips"},{here:(0,z.jsx)(g.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,z.jsxs)("span",{children:[" ",p.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})},ke=C.memo(we),Ce={language:"auto"},Re=(0,C.forwardRef)((function(e,n){var t,r,l=(0,m.useIntl)(),u=e.modelList,c=(0,C.useRef)(0),d=(0,C.useState)([]),p=o()(d,2),f=p[0],v=p[1],h=(0,m.useSearchParams)(),x=o()(h,1)[0],y=x.get("type")||"",b=x.get("model")?"stt"===y&&x.get("model"):"",w=(0,C.useState)({}),k=o()(w,2),R=k[0],M=k[1],N=(0,C.useState)(!1),A=o()(N,2),I=A[0],L=A[1],T=(0,C.useState)(!1),U=o()(T,2),q=U[0],E=U[1],O=(0,C.useState)(null),D=o()(O,2),Y=D[0],B=D[1],G=(0,C.useState)(!1),V=o()(G,2),J=V[0],X=V[1],ae=(0,C.useRef)(null),le=(0,C.useRef)(null),ie=(0,C.useState)(!0),ue=o()(ie,2),oe=ue[0],se=ue[1],pe=(0,C.useState)(null),fe=o()(pe,2),ve=fe[0],me=fe[1],he=(0,C.useState)({data:[],analyser:null}),ge=o()(he,2),xe=ge[0],ye=ge[1],be=(0,C.useState)(!1),je=o()(be,2),we=je[0],Re=je[1],Se=(0,C.useRef)(null),Me=(0,$.U)(),Ze=Me.updateCancelToken,_e=Me.getCanceltToken,Ne=Me.cancelRequest,ze=(0,Q.Z)(),Ae=ze.initialize,Pe=ze.updateScrollerPosition,Ie=(0,Q.Z)().initialize;(0,C.useImperativeHandle)(n,(function(){return{viewCode:function(){L(!0)},setCollapse:function(){X(!J)},collapse:J}}));var Le=function(){c.current=c.current+1},Te=function(){var e=i()(a()().mark((function e(){var n,t,r,l,i,u,o,s,d,p,f;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=Se.current)||void 0===n?void 0:n.form.validateFields();case 2:if(R.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,E(!0),Le(),B(null),v([]),Ne(),Ze(),t=Z()(Z()({},R),{},{file:new File([ve.data],ve.name,{type:ve.type})}),e.next=14,(0,S.wE)({data:t},{cancelToken:_e()});case 14:if(!(null!=(r=e.sent)&&r.status_code&&200!==(null==r?void 0:r.status_code)||null!=r&&r.error)){e.next=18;break}return B({error:!0,errorMessage:(null==r||null===(l=r.data)||void 0===l||null===(l=l.error)||void 0===l?void 0:l.message)||(null==r||null===(i=r.error)||void 0===i?void 0:i.message)||(null==r||null===(u=r.data)||void 0===u?void 0:u.message)||(null==r?void 0:r.detail)||""}),e.abrupt("return");case 18:v([{content:r.text,uid:c.current}]),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(4),(null!=(s=null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o?void 0:o.data)&&s.error||null!=s&&s.status_code&&200!==(null==s?void 0:s.status_code))&&B({error:!0,errorMessage:(null==s||null===(d=s.error)||void 0===d?void 0:d.message)||(null==s||null===(p=s.data)||void 0===p||null===(p=p.error)||void 0===p?void 0:p.message)||(null==s||null===(f=s.data)||void 0===f?void 0:f.error)||(null==s?void 0:s.detail)||""});case 26:return e.prev=26,E(!1),Re(!1),e.finish(26);case 30:case"end":return e.stop()}}),e,null,[[4,21,26,30]])})));return function(){return e.apply(this,arguments)}}(),Ue=(0,C.useCallback)((function(e){me((function(){return{url:e.url,name:e.name,data:e.chunks,type:e.type,duration:e.duration}}))}),[]),qe=(0,C.useCallback)((function(e){se(e)}),[]),Ee=(0,C.useCallback)(function(){var e=i()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(n.file);case 2:t=e.sent,me(t),B(null);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),Fe=(0,C.useCallback)((function(e,n){ye((function(t){return{data:e,analyser:n}}))}),[]),Oe=(0,C.useCallback)((function(e){Re(e),me(null),B(null),v([])}),[]),De=function(){var e=i()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Te();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.useEffect)((function(){ae.current&&Ae(ae.current)}),[ae.current,Ae]),(0,C.useEffect)((function(){le.current&&Ie(le.current)}),[le.current,Ie]),(0,C.useEffect)((function(){q&&Pe()}),[f,q]),(0,z.jsxs)("div",{className:"ground-left-wrapper",style:{height:"calc(100vh - 72px)"},children:[(0,z.jsxs)("div",{className:"ground-left",children:[(0,z.jsx)("div",{className:"ground-left-footer",style:{flex:1},children:(0,z.jsxs)("div",{className:"speech-to-text",children:[(0,z.jsxs)("div",{className:"speech-box",children:[!we&&(0,z.jsx)(W,{type:"default",accept:".mp3,.mp4,.wav",onChange:Ee}),(0,z.jsx)(ce,{type:"default",voiceActivity:!0,onAudioData:Ue,onAudioPermission:qe,onAnalyse:Fe,onRecord:Oe})]}),ve?(0,z.jsxs)("div",{className:"flex-between flex-center justify-center relative",style:{paddingInline:80},children:[(0,z.jsx)("div",{style:{width:600},children:(0,z.jsx)(H,{url:ve.url,name:ve.name,duration:ve.duration})}),(0,z.jsx)("div",{style:{padding:"16px",textAlign:"right",position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:(0,z.jsx)(F.Z,{title:q?l.formatMessage({id:"playground.audio.generating"}):l.formatMessage({id:"playground.audio.button.generate"}),children:(0,z.jsx)(g.ZP,{disabled:!ve,loading:q,type:"primary",shape:"circle",onClick:De,icon:(0,z.jsx)(ne.Z,{})})})})]}):oe?we?(0,z.jsx)(P,{fixedHeight:!0,height:82,width:500,analyserData:xe}):(0,z.jsxs)("div",{className:"tips-text",children:[(0,z.jsx)(s.Z,{type:"icon-audio",style:{fontSize:18}}),(0,z.jsx)("span",{children:l.formatMessage({id:"playground.audio.speechtotext.tips"})})]}):(0,z.jsxs)("div",{className:"tips-text",children:[(0,z.jsx)(s.Z,{type:"icon-audio",style:{fontSize:20}}),(0,z.jsx)("span",{children:l.formatMessage({id:"playground.audio.enablemic"})})]})]})}),(0,z.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"auto"},children:(0,z.jsxs)("div",{className:"message-list-wrap",style:{flex:1,position:"relative",borderTop:"1px solid var(--ant-color-split)"},children:[(null==f?void 0:f.length)>0&&(0,z.jsx)("span",{style:{position:"absolute",top:0,right:2},children:(0,z.jsx)(K.Z,{text:null===(t=f[0])||void 0===t?void 0:t.content})}),(0,z.jsx)("div",{className:"content",style:{height:"100%",overflow:"auto"},ref:ae,children:(0,z.jsxs)("div",{children:[!Y&&(0,z.jsx)("div",{style:{padding:"8px 14px",lineHeight:"20px",display:"flex",justifyContent:"center"},children:f.length?null===(r=f[0])||void 0===r?void 0:r.content:(0,z.jsx)("span",{className:"text-tertiary",children:l.formatMessage({id:"playground.audio.generating.tips"})})}),Y&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",message:null==Y?void 0:Y.errorMessage})})]})}),q&&(0,z.jsx)("div",{style:{width:"100%",flex:1},children:(0,z.jsx)(te.Z,{size:"small",children:(0,z.jsx)("div",{style:{height:"46px"}})})})]})})]}),(0,z.jsx)("div",{className:j()("params-wrapper",{collapsed:J}),ref:le,children:(0,z.jsx)("div",{className:"box",children:(0,z.jsx)(de.Z,{ref:Se,setParams:M,paramsConfig:re.JY,initialValues:Ce,params:R,selectedModel:b,modelList:u})})}),(0,z.jsx)(ke,{open:I,payload:{},api:"audio/transcriptions",clientType:"audio.transcriptions.create",parameters:R,onCancel:function(){L(!1)},title:l.formatMessage({id:"playground.viewcode"})})]})})),Se=(0,C.memo)(Re),Me=t(42779),Ze=t(95618),_e=t(2558),Ne=t(17098),ze=t(67825),Ae=t.n(ze),Pe=t(21970),Ie=["autoplay","audioUrl","speed"],Le=(0,C.forwardRef)((function(e,n){var t=e.autoplay,r=e.audioUrl,l=e.speed,u=void 0===l?1:l,o=Ae()(e,Ie),s=(0,C.useRef)(null),c=(0,C.useRef)(null),d=(0,C.useRef)(null),p=(0,C.useRef)(null),f=(0,C.useRef)(null),v=(0,C.useRef)(null),m=(0,C.useCallback)((function(){d.current=new(window.AudioContext||window.webkitAudioContext),p.current=d.current.createAnalyser(),p.current.fftSize=512,f.current=new Uint8Array(p.current.frequencyBinCount)}),[]),h=(0,C.useCallback)((function(){d.current.createMediaElementSource(v.current).connect(p.current),p.current.connect(d.current.destination)}),[]),g=(k().debounce((function(){var e,n;null!==(e=s.current)&&void 0!==e&&e.isPlaying()&&(null===(n=s.current)||void 0===n||n.pause())}),100),function(){var n,a,l,i,d,g,x,y,b,j;null===(n=s.current)||void 0===n||n.destroy(),s.current=Pe.Z.create(Z()({container:c.current,url:r,autoplay:t,audioRate:u,waveColor:"#4096ff",progressColor:"rgb(100, 0, 100)",height:60,barWidth:2,barGap:1,barRadius:2,interact:!0,cursorWidth:0},o)),v.current=null===(a=s.current)||void 0===a?void 0:a.getMediaElement(),m(),h(),null===(l=s.current)||void 0===l||l.on("ready",(function(n){var t;null===(t=e.onReady)||void 0===t||t.call(e,n)})),null===(i=s.current)||void 0===i||i.on("click",(function(n){var t;null===(t=e.onClick)||void 0===t||t.call(e,n)})),null===(d=s.current)||void 0===d||d.on("finish",(function(){var n;null===(n=e.onFinish)||void 0===n||n.call(e)})),null===(g=s.current)||void 0===g||g.on("audioprocess",(function(n){var t;null===(t=e.onAudioprocess)||void 0===t||t.call(e,n)})),null===(x=s.current)||void 0===x||x.on("seeking",(function(e){})),null===(y=s.current)||void 0===y||y.on("timeupdate",(function(e){})),null===(b=s.current)||void 0===b||b.on("play",(function(){var n,t,r;null===(n=p.current)||void 0===n||n.getByteFrequencyData(f.current),null===(t=e.onAnalyse)||void 0===t||t.call(e,f.current,p),null===(r=e.onPlay)||void 0===r||r.call(e)})),null===(j=s.current)||void 0===j||j.on("pause",(function(){var n,t,r;null===(n=p.current)||void 0===n||n.getByteFrequencyData(f.current),null===(t=e.onAnalyse)||void 0===t||t.call(e,f.current,p),null===(r=e.onPause)||void 0===r||r.call(e)}))}),x=function(){var e=i()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.current&&s.current.play();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){s.current&&s.current.isPlaying()},b=function(){s.current&&s.current.playPause()},j=k().debounce((function(e){s.current&&s.current.seekTo(e)}),50),w=k().debounce((function(e){s.current&&s.current.setTime(e)}),50),R=function(e){s.current&&j(e)},S=function(e){s.current&&w(e)},M=function(){return s.current?s.current.getDuration():0},_=function(){s.current&&s.current.pause()};return(0,C.useImperativeHandle)(n,(function(){return{play:x,pause:_,duration:M,seekTo:R,setTime:S,playPause:b,isPlaying:y,wavesurfer:s}})),(0,C.useEffect)((function(){return c.current&&r&&g(),function(){s.current&&s.current.destroy()}}),[r,c.current]),(0,z.jsx)("div",{ref:c,className:"audio-container",style:{display:"none"}})})),Te=C.memo(Le),Ue=function(e){var n=(0,m.useIntl)(),t=(0,C.useState)(e.autoplay),r=o()(t,2),l=r[0],u=r[1],s=(0,C.useState)(0),c=o()(s,2),d=c[0],p=c[1],f=(0,C.useState)({width:900,height:0}),v=o()(f,2),h=(v[0],v[1]),x=(0,C.useState)(0),y=o()(x,2),b=y[0],j=y[1],R=(0,C.useState)({data:new Uint8Array(128),analyser:null}),S=o()(R,2),M=S[0],_=S[1],N=(0,C.useRef)(null),A=(0,C.useRef)(null),I=(0,C.useCallback)(i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(n=A.current)||void 0===n||null===(n=n.wavesurfer.current)||void 0===n||!n.isPlaying()){e.next=7;break}return null===(t=A.current)||void 0===t||t.pause(),u(!1),e.abrupt("return");case 7:return e.next=9,null===(r=A.current)||void 0===r||null===(r=r.wavesurfer.current)||void 0===r?void 0:r.play();case 9:u(!0);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[A.current]),L=(0,C.useCallback)((function(e,n){_((function(t){return{data:e,analyser:n}}))}),[]),T=(0,C.useCallback)((function(){u(!1)}),[]),U=(0,C.useCallback)((function(){u(!0)}),[]),q=(0,C.useCallback)((function(){u(!1)}),[]),O=(0,w.throttle)((function(e){j(e)}),100),D=(0,C.useCallback)((function(e){O(e)}),[O]),Y=((0,C.useCallback)((function(n){u(e.autoplay),p(n)}),[]),(0,C.useCallback)((function(e){}),[]),(0,C.useCallback)((function(e){h({width:e.width,height:e.height})}),[]),k().debounce((function(e){var n;null===(n=A.current)||void 0===n||n.seekTo(e/d),j(e)}),200)),B=(0,C.useCallback)((function(e){p(e)}),[]),H=((0,C.useCallback)((function(e){var n;null===(n=A.current)||void 0===n||n.seekTo(e/d),j(e)}),[]),(0,C.useCallback)((function(){var n=e.audioUrl||"",t="audio-".concat(ie()().format("YYYYMMDDHHmmss"),".").concat(e.format),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove()}),[e.audioUrl,e.format]));return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"speech-item",children:(0,z.jsxs)("div",{className:"wrapper",style:{height:82,width:"100%"},ref:N,children:[(0,z.jsx)(Te,Z()(Z()({},e),{},{audioUrl:e.audioUrl,onReady:B,onFinish:T,onPlay:U,onPause:q,onAnalyse:L,onAudioprocess:D,ref:A})),l&&(0,z.jsx)(P,{maxBarCount:100,amplitude:60,fixedHeight:!0,height:82,width:800,analyserData:M})]})}),(0,z.jsx)(E.Z,{className:"slider-progress",value:b,max:d,step:.01,onChange:function(e){Y(e)}}),(0,z.jsxs)("div",{className:"speech-actions",children:[(0,z.jsx)("span",{className:"tags",children:(0,z.jsx)("span",{className:"item",children:e.format})}),(0,z.jsx)("span",{className:"duration",children:k().round(b,2)||k().round(d,2)}),(0,z.jsxs)("div",{className:"actions",children:[(0,z.jsx)(F.Z,{title:l?n.formatMessage({id:"playground.audio.button.stop"}):n.formatMessage({id:"playground.audio.button.play"}),children:(0,z.jsx)(g.ZP,{disabled:!e.audioUrl||0===d,onClick:I,icon:l?(0,z.jsx)(Ze.Z,{className:"font-size-16"}):(0,z.jsx)(_e.Z,{className:"font-size-16"}),type:"text",size:"small"})}),(0,z.jsx)(F.Z,{title:n.formatMessage({id:"playground.audio.button.download"}),children:(0,z.jsx)(g.ZP,{disabled:!e.audioUrl||0===d,onClick:H,icon:(0,z.jsx)(Ne.Z,{className:"font-size-16"}),type:"text",size:"small"})})]})]})]})},qe=C.memo(Ue),Ee=function(e){return(0,z.jsx)(z.Fragment,{children:e.dataList.map((function(e){return(0,z.jsx)(qe,Z()({},e),e.uid)}))})},Fe=C.memo(Ee),Oe=t(68476),De=t(26598),Ye="bash",Be="python",He="javascript",Ke=[{label:"Curl",value:Ye},{label:"Python",value:Be},{label:"Nodejs",value:He}],Ge=function(e){var n=e||{},t=n.title,r=n.open,a=n.api,l=n.clientType,i=n.logcommand,u=n.onCancel,s=n.payload,c=n.parameters,d=void 0===c?{}:c,p=(0,m.useIntl)(),f=(0,C.useState)(Ye),v=o()(f,2),h=v[0],x=v[1],y="".concat(window.location.origin,"/v1-openai"),b=(0,C.useMemo)((function(){var e=i?"console.log(response.".concat(i,");"):"console.log(ouptFile);\n  const buffer = Buffer.from(await response.arrayBuffer());\n  await fs.promises.writeFile(ouptFile, buffer);\n",n=i?"print(response.".concat(i,")"):"";if(h===Ye)return"curl ".concat(window.location.origin,"/v1-openai/").concat(a,' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(Z()(Z()({},d),s),null,2),"' \\\n--output output.").concat(d.response_format);if(h===He)return'const fs = require("fs");\nconst path = require("path");\nconst OpenAI = require("openai");\n\nconst ouptFile = path.resolve("./output.'.concat(d.response_format,'");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "').concat(y,'"\n});\n\nasync function main(){\n  const params = ').concat(JSON.stringify(Z()(Z()({},d),s),null,4),";\nconst response = await openai.").concat(l,"(params);\n  ").concat(e,"}\nmain();");if(h===Be){var t=k().keys(d).reduce((function(e,n){if(null===d[n])return e;var t="string"==typeof d[n]?'"'.concat(d[n],'"'):d[n];return e+"  ".concat(n,"=").concat(t,",\n")}),""),r=function(e){return k().keys(e).reduce((function(n,t){if(null===e[t])return n;var r="object"===fe()(e[t])?JSON.stringify(e[t],null,2):'"'.concat(e[t],'"');return n+"  ".concat(t,"=").concat(r,",\n")}),"")}(s);return'from pathlib import Path\nfrom openai import OpenAI\n\nclient = OpenAI(\n  base_url="'.concat(y,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\noutput_file_path = Path(__file__).parent / "output.').concat(d.response_format,'"\nresponse = client.').concat(l,"(\n").concat(t).concat(r,")\n").concat(n,'\nwith open(output_file_path, "wb") as f:\n    for chunk in response.iter_bytes(): \n        f.write(chunk)\n\nprint(f"Audio saved to {output_file_path}")')}return""}),[h,s,d,a,l,i]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(ge.Z,{title:t,open:r,centered:!0,onCancel:function(){x(Ye),u()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,z.jsx)("div",{style:{marginBottom:"10px"},children:p.formatMessage({id:"playground.viewcode.info"})}),(0,z.jsxs)("div",{children:[(0,z.jsx)(ve.Z,{copyText:b,langOptions:Ke,defaultValue:Ye,showHeader:!0,onChangeLang:function(e){x(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,z.jsx)("div",{style:{paddingRight:2,paddingBottom:2},children:(0,z.jsx)(me.Z,{height:380,theme:"dark",code:b,lang:h,copyable:!1})})}),(0,z.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,z.jsx)(he.Z,{className:"m-r-8"}),(0,z.jsx)("span",{children:p.formatMessage({id:"playground.viewcode.tips"},{here:(0,z.jsx)(g.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,z.jsxs)("span",{children:[" ",p.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})},Ve=C.memo(Ge),Je={voice:"",response_format:"mp3"},We=(0,C.forwardRef)((function(e,n){var t=e.modelList,r=(0,C.useRef)(0),l=(0,C.useState)([]),u=o()(l,2),c=u[0],d=u[1],p=(0,m.getLocale)(),f=(0,m.useIntl)(),v=(0,m.useSearchParams)(),h=o()(v,1)[0],g=h.get("type")||"",x=h.get("model")?"tts"===g&&h.get("model"):"",y=(0,C.useState)({}),b=o()(y,2),w=b[0],R=b[1],M=(0,C.useState)(!1),N=o()(M,2),A=N[0],P=N[1],I=(0,C.useState)(!1),L=o()(I,2),T=L[0],U=L[1],q=(0,C.useState)(null),E=o()(q,2),F=E[0],O=E[1],D=(0,C.useState)(null),Y=o()(D,2),B=Y[0],H=Y[1],K=(0,C.useState)(!1),G=o()(K,2),V=G[0],J=G[1],W=(0,C.useRef)(null),$=(0,C.useRef)(null),X=(0,C.useRef)(null),ee=(0,C.useRef)(0),ae=(0,C.useRef)(!0),le=(0,C.useState)(""),ie=o()(le,2),ue=ie[0],oe=ie[1],se=(0,C.useState)([]),ce=o()(se,2),pe=ce[0],fe=ce[1],ve=(0,C.useRef)(null),me=(0,Q.Z)(),he=me.initialize,ge=me.updateScrollerPosition,xe=(0,Q.Z)().initialize;(0,C.useImperativeHandle)(n,(function(){return{viewCode:function(){P(!0)},setCollapse:function(){J(!V)},collapse:V}}));var ye=(0,C.useCallback)((function(e,n){var t="en-US"===e?"english":"chinese";return n.sort((function(e,n){var r=e.value.toLowerCase().includes(t)?1:0;return(n.value.toLowerCase().includes(t)?1:0)-r}))}),[]),be=(0,C.useMemo)((function(){return pe.length?ye(p,pe):[]}),[p,pe,ye]);(0,C.useEffect)((function(){var e,n,t=ye(p,pe);R((function(e){var n;return Z()(Z()({},e),{},{voice:null===(n=t[0])||void 0===n?void 0:n.value})})),null===(e=ve.current)||void 0===e||e.form.setFieldValue("voice",null===(n=t[0])||void 0===n?void 0:n.value)}),[p,pe,ye]);var je=function(){r.current=r.current+1},we=function(){var e=i()(a()().mark((function e(n){var t,l,i,u,o,s,c,p,f,v,m,h,g,x;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=ve.current)||void 0===t?void 0:t.form.validateFields();case 2:if(w.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,U(!0),je(),O(null),oe((null==n?void 0:n.content)||""),d([]),null===(l=W.current)||void 0===l||null===(i=l.abort)||void 0===i||i.call(l),W.current=new AbortController,u=W.current.signal,o=Z()(Z()({},w),{},{input:(null==n?void 0:n.content)||ue}),e.next=16,(0,S.jQ)({data:o,url:S.qt,signal:u});case 16:if(!(null!=(s=e.sent)&&s.status_code&&200!==(null==s?void 0:s.status_code)||null!=s&&s.error)){e.next=22;break}return O({error:!0,errorMessage:(null==s||null===(c=s.data)||void 0===c||null===(c=c.error)||void 0===c?void 0:c.message)||(null==s||null===(p=s.error)||void 0===p?void 0:p.message)||(null==s||null===(f=s.data)||void 0===f?void 0:f.error)||(null==s?void 0:s.detail)||""}),d([]),e.abrupt("return");case 22:d([{input:(null==n?void 0:n.content)||ue,voice:w.voice,format:w.response_format,speed:w.speed,uid:r.current,autoplay:ae.current,audioUrl:s.url}]),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(4),null!=(m=null===e.t0||void 0===e.t0||null===(v=e.t0.response)||void 0===v?void 0:v.data)&&m.error&&O({error:!0,errorMessage:(null==m||null===(h=m.error)||void 0===h?void 0:h.message)||(null==m||null===(g=m.data)||void 0===g||null===(g=g.error)||void 0===g?void 0:g.message)||(null==m||null===(x=m.data)||void 0===x?void 0:x.error)||(null==m?void 0:m.detail)||""});case 30:return e.prev=30,U(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[4,25,30,33]])})));return function(n){return e.apply(this,arguments)}}(),ke=(0,C.useCallback)(function(){var e=i()(a()().mark((function e(n){var t,r,l,i,u,o,s,c,d,f,v,m,h,g;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,S.zv)({model:n});case 5:if(!(null!=(l=e.sent)&&l.status_code&&200!==(null==l?void 0:l.status_code)||null!=l&&l.error)){e.next=10;break}return H({error:!0,errorMessage:(null==l||null===(i=l.data)||void 0===i||null===(i=i.error)||void 0===i?void 0:i.message)||(null==l||null===(u=l.error)||void 0===u?void 0:u.message)||(null==l||null===(o=l.data)||void 0===o?void 0:o.error)||(null==l?void 0:l.detail)||""}),fe([]),e.abrupt("return");case 10:s=k().map(l.voices||[],(function(e){return{label:e,value:e}})),c=ye(p,s),fe(c),H(null),R((function(e){var n;return Z()(Z()({},e),{},{voice:null===(n=c[0])||void 0===n?void 0:n.value})})),null===(t=ve.current)||void 0===t||t.form.setFieldValue("voice",null===(r=c[0])||void 0===r?void 0:r.value),e.next=25;break;case 18:e.prev=18,e.t0=e.catch(2),(null!=(v=null===e.t0||void 0===e.t0||null===(d=e.t0.response)||void 0===d?void 0:d.data)&&v.error||null!=v&&v.status_code&&200!==(null==v?void 0:v.status_code))&&H({error:!0,errorMessage:(null==v||null===(m=v.error)||void 0===m?void 0:m.message)||(null==v||null===(h=v.data)||void 0===h||null===(h=h.error)||void 0===h?void 0:h.message)||(null==v||null===(g=v.data)||void 0===g?void 0:g.error)||(null==v?void 0:v.detail)||""}),fe([]),null===(f=ve.current)||void 0===f||f.form.setFieldValue("voice",""),R((function(e){return Z()(Z()({},e),{},{voice:""})}));case 25:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(n){return e.apply(this,arguments)}}(),[t]),Ce=(0,C.useMemo)((function(){return re.I_.map((function(e){return(0,z.jsx)(Oe.Z.Item,{name:e.name,rules:e.rules,children:(0,z.jsx)(Me.Z,Z()(Z()({},e.attrs),{},{options:"voice"===e.name?be:e.options,label:e.label.isLocalized?f.formatMessage({id:e.label.text}):e.label.text}))},e.name)}))}),[re.I_,f,be]),Re=(0,C.useMemo)((function(){return B?(0,z.jsx)(z.Fragment,{children:B&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",ellipsis:!1,style:{textAlign:"left"},message:f.formatMessage({id:"playgorund.audio.voice.error"})})})}):null}),[B]);return(0,C.useEffect)((function(){ke(w.model)}),[w.model,ke]),(0,C.useEffect)((function(){$.current&&he($.current)}),[$.current,he]),(0,C.useEffect)((function(){X.current&&xe(X.current)}),[X.current,xe]),(0,C.useEffect)((function(){T&&ge()}),[c,T]),(0,C.useEffect)((function(){c.length>ee.current&&ge(),ee.current=c.length}),[c.length]),(0,z.jsxs)("div",{className:"ground-left-wrapper",children:[(0,z.jsxs)("div",{className:"ground-left",children:[(0,z.jsx)("div",{className:"message-list-wrap",children:(0,z.jsx)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,z.jsxs)("div",{className:"content",style:{maxWidth:1e3},children:[c.length?(0,z.jsx)(Fe,{dataList:c,loading:T}):(0,z.jsxs)("div",{className:"flex-column font-size-14 flex-center gap-20",children:[(0,z.jsx)("span",{children:(0,z.jsx)(s.Z,{type:"icon-audio ",className:"font-size-32 text-secondary"})}),(0,z.jsx)("span",{children:f.formatMessage({id:"playground.audio.texttospeech.tips"})})]}),T&&(0,z.jsx)(te.Z,{size:"small",children:(0,z.jsx)("div",{style:{height:"46px"}})})]})})}),F&&(0,z.jsx)("div",{style:{height:40},children:(0,z.jsx)(_.Z,{type:"danger",message:null==F?void 0:F.errorMessage})}),(0,z.jsx)("div",{className:"ground-left-footer",children:(0,z.jsx)(De.Z,{actions:["check","clear"],checkLabel:f.formatMessage({id:"playground.toolbar.autoplay"}),placeholer:f.formatMessage({id:"playground.input.text.holder"}),defaultSize:{minRows:5,maxRows:5},title:(0,z.jsx)("span",{className:"font-600",children:f.formatMessage({id:"playground.audio.textinput"})}),onCheck:function(e){ae.current=e.target.checked},loading:T,disabled:!w.model,isEmpty:!0,handleSubmit:function(e){we(e)},handleAbortFetch:function(){var e,n;null===(e=W.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),U(!1)},onInputChange:function(e){oe(e.target.value)},clearAll:function(){je(),d([]),O(null)},shouldResetMessage:!1,submitIcon:(0,z.jsx)(ne.Z,{})})})]}),(0,z.jsx)("div",{className:j()("params-wrapper",{collapsed:V}),ref:X,children:(0,z.jsx)("div",{className:"box",children:(0,z.jsx)(de.Z,{ref:ve,setParams:R,initialValues:Je,params:w,selectedModel:x,modelList:t,extra:[Ce,Re]})})}),(0,z.jsx)(Ve,{open:A,payload:{input:ue},api:"audio/speech",clientType:"audio.speech.create",parameters:w,onCancel:function(){P(!1)},title:f.formatMessage({id:"playground.viewcode"})})]})})),Qe=(0,C.memo)(We),$e=(t(20988),"tts"),Xe="stt",en=function(){var e=(0,m.useIntl)(),n=(0,m.useSearchParams)(),t=o()(n,1)[0].get("type")||"",r=(0,p.Z)().size,l=(0,C.useState)(t||$e),u=o()(l,2),b=u[0],w=u[1],M=(0,C.useRef)(null),Z=(0,C.useRef)(null),_=(0,C.useState)([]),N=o()(_,2),A=N[0],P=N[1],I=(0,C.useState)([]),L=o()(I,2),T=L[0],U=L[1],q=(0,C.useState)(!1),E=o()(q,2),F=E[0],O=E[1],D=[{label:e.formatMessage({id:"playground.audio.texttospeech"}),value:$e,icon:(0,z.jsx)(f.Z,{})},{label:e.formatMessage({id:"playground.audio.speechtotext"}),value:Xe,icon:(0,z.jsx)(s.Z,{type:"icon-audio"})}],Y=(0,C.useCallback)((function(){var e,n;if(b===$e)null===(e=M.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e);else if(b===Xe){var t,r;null===(t=Z.current)||void 0===t||null===(r=t.viewCode)||void 0===r||r.call(t)}}),[b]),B=(0,C.useCallback)((function(){var e,n,t,r;b!==$e?null===(e=Z.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e):null===(t=M.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t)}),[b]),H=[{key:"tts",label:"TTS",children:(0,z.jsx)(Qe,{ref:M,modelList:A})},{key:"stt",label:"Realtime",children:(0,z.jsx)(Se,{modelList:T,loaded:F,ref:Z})}];(0,C.useEffect)((function(){var e,n,t;r.width<c.Z.lg&&(null!==(e=M.current)&&void 0!==e&&e.collapse||null===(n=M.current)||void 0===n||null===(t=n.setCollapse)||void 0===t||t.call(n))}),[r.width]),(0,C.useEffect)((function(){var e=function(){var e=i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={text_to_speech:!0},e.next=4,(0,S.nb)(n);case 4:return t=e.sent,r=k().map(t.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=i()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={speech_to_text:!0},e.next=4,(0,S.nb)(n);case 4:return t=e.sent,r=k().map(t.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=i()(a()().mark((function t(){var r,l,i,u;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e(),n()]);case 3:r=t.sent,l=o()(r,2),i=l[0],u=l[1],P(i),U(u),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),O(!0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}();t()}),[]);return(0,R.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=M.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,z.jsx)(v._z,{ghost:!0,header:{title:(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.speech"})}),(0,z.jsx)(x.Z,{options:D,size:"middle",className:"m-l-40",value:b,onChange:function(e){return w(e)}})]}),breadcrumb:{}},extra:(0,z.jsxs)(h.Z,{children:[(0,z.jsx)(g.ZP,{size:"middle",onClick:Y,icon:(0,z.jsx)(s.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,z.jsx)(g.ZP,{size:"middle",onClick:B,icon:(0,z.jsx)(s.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:j()("playground-container",{compare:"compare"===b,chat:"compare"!==b}),children:(0,z.jsx)("div",{className:"play-ground",children:(0,z.jsx)("div",{className:"chat",children:(0,z.jsx)(y.Z,{items:H,activeKey:b})})})})}}}]);