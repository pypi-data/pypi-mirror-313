"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8268],{33883:function(e,n,t){t.d(n,{Z:function(){return y}});var r=t(26068),a=t.n(r),s=t(48305),o=t.n(s),i=t(67825),l=t.n(i),c=t(23333),u=t(76808),d=t(32699),p=t(50959),f=t(571),m=t(11527),h=function(e){var n=e.isOverflowing,t=e.showTitle,r=e.title,a=e.children,s=(0,f.Z)().initialize,o=p.useRef(null);return p.useEffect((function(){o.current&&s(o.current)}),[s,o.current]),(0,m.jsx)("div",{style:{maxHeight:200,overflowY:"auto"},ref:o,children:(0,m.jsx)("div",{style:{width:"max-content",maxWidth:250,paddingInline:10},children:n||t?r||a:""})})},g=p.memo(h),v=["children","maxWidth","minWidth","ghost","title","showTitle","tooltipProps"],x=function(e){var n=e.children,t=e.maxWidth,r=void 0===t?"100%":t,s=e.minWidth,i=e.ghost,f=void 0!==i&&i,h=e.title,x=e.showTitle,y=void 0!==x&&x,b=e.tooltipProps,w=l()(e,v),j=(0,p.useRef)(null),k=(0,p.useState)(!1),Z=o()(k,2),S=Z[0],M=Z[1],N=((0,p.useRef)(),(0,p.useCallback)((function(){if(j.current){var e=j.current,n=e.scrollWidth,t=e.clientWidth;M(n>t)}}),[j.current]));(0,p.useEffect)((function(){var e=(0,d.throttle)(N,200);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[N]),(0,p.useEffect)((function(){N()}),[n,N]);var C=(0,p.useMemo)((function(){return a()({maxWidth:r,minWidth:s,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},w.style)}),[r,w.style]);return(0,m.jsx)(c.Z,a()(a()({overlayInnerStyle:{paddingInline:0},destroyTooltipOnHide:!1,title:S||y?(0,m.jsx)(g,{isOverflowing:S,title:h,showTitle:y,children:n}):""},b),{},{children:f?(0,m.jsx)("div",{ref:j,style:C,children:n}):(0,m.jsx)(u.Z,a()(a()({},w),{},{ref:j,style:C,children:n}))}))},y=p.memo(x)},16850:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(26068),a=t.n(r),s=t(60857),o=t(50959),i=t(42034),l=t(11527),c=function(e){var n=e.header,t=e.children,r=e.copyText,o=e.langOptions,c=e.onChangeLang,u=e.defaultValue,d=e.styles,p=void 0===d?{}:d,f=e.showHeader,m=void 0===f||f,h=function(e){null==c||c(e)};return(0,l.jsxs)("div",{className:"editor-wrap",style:a()({},p.wrapper),children:[n?(0,l.jsx)("div",{className:"editor-header",children:n}):m?(0,l.jsxs)("div",{className:"editor-header",children:[(0,l.jsx)(s.default,{defaultValue:u,style:{width:120},size:"middle",variant:"filled",options:o,onChange:h}),(0,l.jsx)(i.Z,{text:r,size:"small",style:{color:"rgba(255,255,255,.7)"}})]}):null,(0,l.jsx)("div",{className:"editor-content",children:t})]})},u=o.memo(c)},75489:function(e,n,t){var r=t(26068),a=t.n(r),s=t(82187),o=t.n(s),i=(t(50959),t(88641)),l=t(1066),c=t(11527);n.Z=function(e){var n=e.children,t=e.label,r=e.status,s=e.className,u=e.disabled,d=e.required,p=e.variant,f=e.style,m=e.description;return(0,c.jsxs)("div",{style:a()({padding:"0 calc(var(--ant-padding-sm) - 5px)",width:"100%"},f),className:o()(l.Z.wrapper,l.Z["validate-status-".concat(r)],u?l.Z["seal-input-wrapper-disabled"]:"","filled"===p?l.Z.filled:"","borderless"===p?l.Z.borderless:"",s?l.Z[s]:""),children:[(0,c.jsx)("label",{className:o()(l.Z.label,l.Z["isfoucs-has-value"]),children:(0,c.jsx)(i.Z,{label:t,required:d,description:m})}),(0,c.jsx)("div",{className:"child-inner",style:{width:"100%"},children:n})]})}},13770:function(e,n,t){t.d(n,{d:function(){return r}});var r={default:500,large:600,small:400,mini:300}},35014:function(e,n,t){t.d(n,{AA:function(){return d},U$:function(){return c},jQ:function(){return f},nb:function(){return u},qt:function(){return l},wE:function(){return m},xO:function(){return p},zv:function(){return h}});var r=t(90228),a=t.n(r),s=t(87999),o=t.n(s),i=t(99178),l="/v1-openai/chat/completions",c="/v1-openai/images/generations";var u=function(){var e=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("".concat("/v1-openai/models"),{method:"GET",params:n}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),d=function(){var e=o()(a()().mark((function e(n,t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("".concat("/rerank"),{method:"POST",data:n,cancelToken:null==t?void 0:t.cancelToken}));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),p=function(){var e=o()(a()().mark((function e(n,t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("".concat("/v1-openai/embeddings"),{method:"POST",data:n,cancelToken:null==t?void 0:t.cancelToken}));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),f=function(){var e=o()(a()().mark((function e(n,t){var r,s,o,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/v1-openai/audio/speech",{method:"POST",body:JSON.stringify(n.data),signal:n.signal});case 2:if((s=e.sent).ok){e.next=7;break}return e.next=6,s.json();case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,s.blob();case 9:if(-1!==(null==(o=e.sent)||null===(r=o.type)||void 0===r?void 0:r.indexOf("audio"))){e.next=12;break}return e.abrupt("return",{url:"",type:""});case 12:return i=o.size>0?URL.createObjectURL(o):"",e.abrupt("return",{url:i,type:o.type});case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),m=function(){var e=o()(a()().mark((function e(n,t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/v1-openai/audio/transcriptions",{method:"POST",data:n.data,cancelToken:null==t?void 0:t.cancelToken,headers:{"Content-Type":"multipart/form-data"}}));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),h=function(){var e=o()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/voices",{method:"GET",params:n,skipErrorHandler:!0}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},19748:function(e,n,t){var r=t(26068),a=t.n(r),s=t(31759),o=t.n(s),i=t(48305),l=t.n(i),c=t(16850),u=t(16333),d=t(90515),p=t(99178),f=t(1956),m=t(85885),h=t(32699),g=t.n(h),v=t(50959),x=t(11527),y="bash",b="python",w="javascript",j=[{label:"Curl",value:y},{label:"Python",value:b},{label:"Nodejs",value:w}],k=function(e){var n=e||{},t=n.title,r=n.open,s=n.api,i=n.clientType,h=n.logcommand,k=n.onCancel,Z=n.payload,S=n.parameters,M=void 0===S?{}:S,N=(0,p.useIntl)(),C=(0,v.useState)(y),T=l()(C,2),R=T[0],_=T[1],A="".concat(window.location.origin,"/v1-openai"),P=(0,v.useMemo)((function(){var e=h?"console.log(response.".concat(h,");\n"):"",n=h?"print(response.".concat(h,")"):"";if(R===y)return"curl ".concat(window.location.origin,"/v1-openai/").concat(s,' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Bearer ${YOUR_GPUSTACK_API_KEY}" \\\n-d \'').concat(JSON.stringify(a()(a()({},M),Z),null,2),"'");if(R===w)return'const OpenAI = require("openai");\n\nconst openai = new OpenAI({\n  "apiKey": "YOUR_GPUSTACK_API_KEY",\n  "baseURL": "'.concat(A,'"\n});\n\nasync function main(){\n  const params = ').concat(JSON.stringify(a()(a()({},M),Z),null,4),";\nconst response = await openai.").concat(i,"(params);\n  ").concat(e,"}\nmain();");if(R===b){var t=g().keys(M).reduce((function(e,n){if(null===M[n])return e;var t="string"==typeof M[n]?'"'.concat(M[n],'"'):M[n];return e+"  ".concat(n,"=").concat(t,",\n")}),""),r=function(e){return g().keys(e).reduce((function(n,t){if(null===e[t])return n;var r="object"===o()(e[t])?JSON.stringify(e[t],null,2):'"'.concat(e[t],'"');return n+"  ".concat(t,"=").concat(r,",\n")}),"")}(Z);return'from openai import OpenAI\n\nclient = OpenAI(\n  base_url="'.concat(A,'", \n  api_key="YOUR_GPUSTACK_API_KEY"\n)\n\nresponse = client.').concat(i,"(\n").concat(t).concat(r,")\n").concat(n)}return""}),[R,Z,M,s,i,h]);return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(f.Z,{title:t,open:r,centered:!0,onCancel:function(){_(y),k()},destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:600,footer:null,children:[(0,x.jsx)("div",{style:{marginBottom:"10px"},children:N.formatMessage({id:"playground.viewcode.info"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)(c.Z,{copyText:P,langOptions:j,defaultValue:y,showHeader:!0,onChangeLang:function(e){_(e)},styles:{wrapper:{backgroundColor:"var(--color-editor-dark)"}},children:(0,x.jsx)("div",{style:{paddingRight:2,paddingBottom:2},children:(0,x.jsx)(u.Z,{height:380,theme:"dark",code:P,lang:R,copyable:!1})})}),(0,x.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"baseline"},children:[(0,x.jsx)(d.Z,{className:"m-r-8"}),(0,x.jsx)("span",{children:N.formatMessage({id:"playground.viewcode.tips"},{here:(0,x.jsx)(m.ZP,{type:"link",size:"small",href:"#/api-keys",target:"_blank",style:{paddingInline:2},children:(0,x.jsxs)("span",{children:[" ",N.formatMessage({id:"playground.viewcode.here"})]})})})})]})]})]})})};n.Z=v.memo(k)},9298:function(e,n,t){t.d(n,{G7:function(){return r},NW:function(){return s},ce:function(){return o},kA:function(){return a}});t(26068),t(32699);var r={User:"user",Assistant:"assistant",System:"system"},a=(r.User,r.Assistant,function(e){if(!e.length)return[];var n=[];return e.forEach((function(e){var t;if(null!==(t=e.imgs)&&void 0!==t&&t.length){var r=e.imgs.map((function(e){return{type:"image_url",image_url:{url:e.dataUrl}}}));n.push({role:e.role,content:r})}e.content&&n.push({role:e.role,content:e.content})})),n}),s={chat:{api:"chat/completions",clientType:"chat.completions.create",logcommand:"choices[0].message.content"},embeddings:{api:"embeddings",clientType:"embedding.create",logcommand:"data[0].embedding"},images:{api:"images/generations",clientType:"images.generate",logcommand:"data[0].b64_json"},imageAdvanced:{api:"/v1-openai/images/generations",clientType:"images.generate",logcommand:{python:"json()['data'][0]['b64_json']",node:"data.data[0].b64_json"}},rerank:{api:"/v1/rerank",logcommand:{python:"json()",node:"data"}}},o=["a lovely cat.","Digital art, portrait of an anthropomorphic roaring Tiger warrior with full armor, close up in the middle of a battle, behind him there is a banner with the text 'Open Source'.","An astronaut riding a green horse.","a female character with long, flowing hair that appears to be made of ethereal, swirling patterns resembling the Northern Lights or Aurora Borealis. The background is dominated by deep blues and purples, creating a mysterious and dramatic atmosphere. The character's face is serene, with pale skin and striking features. She wears a dark-colored outfit with subtle patterns. The overall style of the artwork is reminiscent of fantasy or supernatural genres.","A whimsical and creative image depicting a hybrid creature that is a mix of a waffle and a hippopotamus, basking in a river of melted butter amidst a breakfast-themed landscape. It features the distinctive, bulky body shape of a hippo. However, instead of the usual grey skin, the creature's body resembles a golden-brown, crispy waffle fresh off the griddle. The skin is textured with the familiar grid pattern of a waffle, each square filled with a glistening sheen of syrup. The environment combines the natural habitat of a hippo with elements of a breakfast table setting, a river of warm, melted butter, with oversized utensils or plates peeking out from the lush, pancake-like foliage in the background, a towering pepper mill standing in for a tree.  As the sun rises in this fantastical world, it casts a warm, buttery glow over the scene. The creature, content in its butter river, lets out a yawn. Nearby, a flock of birds take flight.","A cinematic shot of a baby racoon wearing an intricate italian priest robe.","Create portraits of characters in the style of classical oil painting, Capturing the essence of Chinese aristocracy in the Han Dynasty period. This portrait should feature a Chinese male character dressed in exquisite and gorgeous Chinese Han style clothing, with a dignified demeanor. The background should be a simple and elegant wallpaper pattern, with the face and upper body of the character as the focus. The lighting should be soft and diffuse, highlighting the characteristics of the character and the complex details of the clothing. The color palette should be rich and warm, with red, gold, and dark green.","photo of a young woman with long, wavy brown hair tied in a bun and glasses. She has a fair complexion and is wearing subtle makeup, emphasizing her eyes and lips. She is dressed in a black top. The background appears to be an urban setting with a building facade, and the sunlight casts a warm glow on her face.","A portrait of women with blue eyes.","A close-up image of a light brown and cream-colored Bengal kitten, lying on a cream-colored surface, with a person's hand gently touching the kitten's head, capturing the soft textures of the fur and the subtle patterns, emphasizing the natural light and shadow play on the animal's body.","A German Shepherd dog playfully carrying a stick, with a smaller German Shepherd puppy running alongside in a grassy field, showcasing a rich, natural color palette of greens, browns, and tans, and a dynamic action shot with a focus on vibrant texture and depth of field.","A young woman with long, dark, wavy hair, wearing a light olive green flowing dress, looks directly at the camera, standing near a window with a soft out-of-focus background of dark green curtains and light green.  The image should be sharp, focused on the woman's face, and evoke a natural, soft beauty aesthetic with a slightly muted color palette.","A sleepy panda cub rests comfortably on a large, ornate tree branch, its black and white fur contrasting against the reddish-brown bark of the textured, sculpted tree trunk, surrounded by lush green foliage and branches.  ","A full shot of two people jogging at sunset,  featuring a vibrant, warm color palette shifting from twilight blues to peachy-orange tones, with visible sun rays and lens flares, conveying a sense of leisure and athleticism.","A close-up portrait of a golden retriever wearing black-framed glasses,  exhibiting a rich golden-brown coat with a fluffy texture,  and a neutral, light gray background."]},69406:function(e,n,t){t.r(n),t.d(n,{default:function(){return ze}});var r=t(90228),a=t.n(r),s=t(87999),o=t.n(s),i=t(48305),l=t.n(i),c=t(83057),u=t(35445),d=t(93495),p=t(55592),f=t(92067),m=t(63830),h=t(55169),g=t(99178),v=t(54235),x=t(85885),y=t(96938),b=t(47946),w=t(82187),j=t.n(w),k=t(32699),Z=t.n(k),S=t(50959),M=t(94299),N=t(35014),C=t(26068),T=t.n(C),R=t(15558),_=t.n(R),A=t(571),P=t(81117),O=t(54876),I=(t(72183),t(9298)),E=(t(51662),t(21435),t(26598)),z=(t(9763),t(42034)),L=t(81e3),F=t(23333),D=t(8267),G=t(38852),U=t(2565),q=t(11527),V=function(e){var n,t,r,s=e.updateMessage,i=e.onDelete,l=e.loading,c=e.data,u=e.editable,d=e.showTitle,p=void 0===d||d,f=e.actions,m=void 0===f?["upload","delete","copy"]:f,h=(0,g.useIntl)(),v=(0,S.useRef)(null),y=(0,S.useRef)(0),b=(0,S.useCallback)(function(){var e=o()(a()().mark((function e(n){var t,r,o,i,l,u,d;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.clipboardData||window.clipboardData,r=t.items,o=[],i=a()().mark((function e(){var n,t,s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"file"===(n=r[l]).kind&&-1!==n.type.indexOf("image")?(t=n.getAsFile(),s=new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var r,a=null===(r=t.target)||void 0===r?void 0:r.result;a?e(a):n("Failed to convert image to base64")},r.readAsDataURL(t)})),o.push(s)):n.kind;case 2:case"end":return e.stop()}}),e)})),l=0;case 5:if(!(l<r.length)){e.next=10;break}return e.delegateYield(i(),"t0",7);case 7:l++,e.next=5;break;case 10:return e.prev=10,e.next=13,Promise.all(o);case 13:(u=e.sent).length&&(d=Z().map(u,(function(e){return y.current+=1,{uid:y.current,dataUrl:e}})),null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(_()(c.imgs||[]),_()(d))})),e.next=20;break;case 17:e.prev=17,e.t1=e.catch(10);case 20:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(n){return e.apply(this,arguments)}}(),[c,s]),w=(0,S.useCallback)((function(e){null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:[].concat(_()(c.imgs||[]),_()(e))})}),[c,s]),k=function(e){var n=Z().filter(c.imgs,(function(n){return n.uid!==e}));null==s||s({role:c.role,content:c.content,uid:c.uid,imgs:n})},M=(0,S.useCallback)((function(){var e;if(c.imgs&&(null===(e=c.imgs)||void 0===e?void 0:e.length)>0){var n=_()(c.imgs||[]).pop();n&&k(n.uid)}}),[c.imgs,k]),N=(0,S.useCallback)((function(e){var n;"Backspace"===e.key&&""===c.content&&c.imgs&&(null===(n=c.imgs)||void 0===n?void 0:n.length)>0&&(e.preventDefault(),M())}),[c,M]);return(0,q.jsxs)("div",{className:"content-item",children:[(0,q.jsxs)("div",{className:"content-item-role",style:{display:p||m.length?"flex":"none"},children:[p&&(0,q.jsx)("div",{className:"role",children:null!==(n=c.title)&&void 0!==n?n:h.formatMessage({id:"playground.".concat(c.role)})}),(0,q.jsxs)("div",{className:"actions",children:[m.includes("upload")&&c.role===I.G7.User&&(0,q.jsx)(U.Z,{handleUpdateImgList:w}),c.content&&m.includes("copy")&&(0,q.jsx)(z.Z,{text:c.content,size:"small",shape:"default",type:"text",fontSize:"12px"}),m.includes("delete")&&(0,q.jsx)(F.Z,{title:h.formatMessage({id:"common.button.delete"}),children:(0,q.jsx)(x.ZP,{size:"small",type:"text",onClick:i,icon:(0,q.jsx)(L.Z,{})})})]})]}),u?(0,q.jsxs)("div",{className:j()("message-content-input",{"has-img":null===(t=c.imgs)||void 0===t?void 0:t.length}),onClick:function(e){e.stopPropagation(),e.preventDefault(),v.current.focus()},children:[(0,q.jsx)(G.Z,{editable:u,dataList:c.imgs||[],onDelete:k}),(0,q.jsx)(D.Z.TextArea,{ref:v,value:c.content,variant:"filled",autoSize:{minRows:1},style:{borderRadius:"var(--border-radius-mini)"},readOnly:l,onKeyDown:N,onChange:function(e){null==s||s({imgs:c.imgs||[],role:c.role,content:e.target.value,uid:c.uid})},onPaste:function(e){e.clipboardData.getData("text")||(e.preventDefault(),b(e))}})]}):(0,q.jsxs)("div",{className:j()("content-item-content",{"has-img":null===(r=c.imgs)||void 0===r?void 0:r.length}),children:[(0,q.jsx)(G.Z,{editable:u,dataList:c.imgs||[],onDelete:k}),c.content&&(0,q.jsx)("div",{className:"text",children:c.content})]})]})},W=S.memo(V),B=function(e){var n=e.setMessageList,t=e.messageList,r=e.editable,a=e.showTitle,s=void 0===a||a,o=e.actions,i=void 0===o?["upload","delete","copy"]:o;return(0,q.jsx)(q.Fragment,{children:!!t.length&&(0,q.jsx)("div",{className:"message-content-list",children:t.map((function(e,a){return(0,q.jsx)(W,{data:e,editable:r,actions:i,showTitle:s,onDelete:function(){return function(e){var r=_()(t);r.splice(e,1),null==n||n(r)}(a)},updateMessage:function(e){return function(e,r){var a=_()(t);a[e]=r,null==n||n(a)}(a,e)}},e.uid)}))})})},H=S.memo(B),K=t(43943),Y=t(83603),J=t(76571),$=function(e){var n=e.systemMessage,t=e.showApplyToAll,r=e.setSystemMessage,a=e.style,s=e.applyToAll,o=(0,g.useIntl)(),i=(0,S.useState)(!1),c=l()(i,2),u=c[0],d=c[1],p=S.useRef(null),f=(0,S.useState)({minRows:1,maxRows:1,focus:!1}),m=l()(f,2),h=m[0],v=m[1],y=function(){v({minRows:4,maxRows:4,focus:!0}),setTimeout((function(){var e,n;null===(e=p.current)||void 0===e||null===(n=e.focus)||void 0===n||n.call(e,{cursor:"end"})}),100)};return(0,S.useEffect)((function(){u&&(null==s||s(n))}),[u]),(0,q.jsxs)("div",{className:j()("sys-message",{focus:h.focus}),style:T()({},a),children:[(0,q.jsxs)("div",{style:{display:h.focus?"block":"none"},className:"textarea-wrapper",children:[(0,q.jsx)("span",{className:"system-label",children:o.formatMessage({id:"playground.systemMessage"})}),(0,q.jsx)(D.Z.TextArea,{className:"custome-scrollbar",ref:p,variant:"filled",placeholder:o.formatMessage({id:"playground.system.tips"}),style:{borderRadius:"0",border:"none"},value:n,autoSize:{minRows:h.minRows,maxRows:h.maxRows},onFocus:y,onBlur:function(e){v({minRows:1,maxRows:1,focus:!1})},allowClear:!1,onChange:function(e){r(e.target.value),u&&(null==s||s(e.target.value))}}),t&&(0,q.jsxs)("span",{className:"apply-check",onMouseDown:function(e){e.preventDefault(),d(!u)},children:[(0,q.jsx)("span",{className:"m-r-5",children:o.formatMessage({id:"playground.compare.applytoall"})}),(0,q.jsx)(Y.Z,{checked:u})]}),(0,q.jsx)(J.Z,{style:{margin:"0"}})]}),!h.focus&&(0,q.jsxs)("div",{className:"sys-content-wrap",onClick:y,children:[(0,q.jsxs)("div",{className:"sys-content",children:[(0,q.jsx)("span",{className:"title",children:o.formatMessage({id:"playground.systemMessage"})}),n||(0,q.jsx)("span",{style:{color:"var(--ant-color-text-tertiary)"},children:o.formatMessage({id:"playground.system.tips"})})]}),n&&(0,q.jsx)(F.Z,{title:o.formatMessage({id:"common.button.clear"}),children:(0,q.jsx)(x.ZP,{className:"clear-btn",type:"text",icon:(0,q.jsx)(K.Z,{}),size:"small",onClick:function(){r("")}})})]})]})},Q=S.memo($),X=t(82092),ee=t.n(X),ne=t(75489),te=t(92233),re=t(42779),ae=t(13770),se=t(4423),oe=t(68476),ie=t(40474),le=t(96247),ce=t(26938),ue=function(e){var n=e.selectedModel,t=e.setParams,r=e.globalParams,a=e.onValuesChange,s=e.modelList,o=e.showModelSelector,i=void 0===o||o,c=(0,g.useIntl)(),u=T()({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024},r),d=oe.Z.useForm(),p=l()(d,1)[0],f=(0,S.useId)();(0,S.useEffect)((function(){i?(p.setFieldsValue(T()(T()({},u),{},{model:n||Z().get(s,"[0].value")})),t(T()(T()({},u),{},{model:n||Z().get(s,"[0].value")}))):(p.setFieldsValue(T()(T()({},u),{},{model:n||""})),t(T()(T()({},u),{},{model:n||""})))}),[s,i,n]);var m=(0,S.useCallback)((function(e,n){null==t||t(n),null==a||a(e,n)}),[a,t]),h=(0,S.useCallback)((function(e,n){var r=p.getFieldsValue();p.setFieldsValue(T()(T()({},r),{},ee()({},n,e))),t(T()(T()({},r),{},ee()({},n,e))),null==a||a(ee()({},n,e),T()(T()({},r),{},ee()({},n,e)))}),[p,t,a]);(0,S.useEffect)((function(){p.setFieldsValue(r)}),[r]);var v=function(e){return(0,q.jsxs)("span",{className:ce.Z.label,style:{width:ae.d.mini},children:[(0,q.jsx)("span",{className:"text",children:e.description?(0,q.jsxs)(F.Z,{title:e.description,children:[(0,q.jsxs)("span",{children:[" ",e.label]}),(0,q.jsx)("span",{className:"m-l-5",children:(0,q.jsx)(se.Z,{})})]}):(0,q.jsx)("span",{children:e.label})}),(0,q.jsx)(ie.Z,{className:"label-val",variant:"outlined",size:"small",value:p.getFieldValue(e.field),controls:!1,onChange:function(n){return h(n,e.field)}})]})};return(0,q.jsx)(oe.Z,{name:f,form:p,onValuesChange:m,onFinish:function(e){},onFinishFailed:function(e){},children:(0,q.jsxs)("div",{children:[i&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h3",{className:"m-b-20 m-l-10 font-size-14 line-24",children:c.formatMessage({id:"playground.model"})}),(0,q.jsx)(oe.Z.Item,{name:"model",rules:[{required:!0,message:c.formatMessage({id:"common.form.rule.select"},{name:c.formatMessage({id:"playground.model"})})}],children:(0,q.jsx)(re.Z,{showSearch:!0,options:s})})]}),(0,q.jsx)("h3",{className:"m-b-20 m-l-10 flex-between flex-center font-size-14 line-24",children:(0,q.jsx)("span",{children:c.formatMessage({id:"playground.parameters"})})}),(0,q.jsx)(oe.Z.Item,{name:"temperature",rules:[{required:!1}],children:(0,q.jsx)(ne.Z,{label:v({field:"temperature",label:"Temperature",description:c.formatMessage({id:"playground.params.temperature.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,q.jsx)(le.Z,{defaultValue:1,max:2,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:p.getFieldValue("temperature")||void 0,onChange:function(e){return h(e,"temperature")}})})}),(0,q.jsx)(oe.Z.Item,{name:"max_tokens",rules:[{required:!1}],children:(0,q.jsx)(ne.Z,{label:v({field:"max_tokens",label:"Max Tokens",description:c.formatMessage({id:"playground.params.maxtokens.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,q.jsx)(le.Z,{defaultValue:2048,max:16384,step:1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:p.getFieldValue("max_tokens")||void 0,onChange:function(e){return h(e,"max_tokens")}})})}),(0,q.jsx)(oe.Z.Item,{name:"top_p",rules:[{required:!1}],children:(0,q.jsx)(ne.Z,{label:v({field:"top_p",label:"Top P",description:c.formatMessage({id:"playground.params.topp.tips"})}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,q.jsx)(le.Z,{defaultValue:1,max:1,step:.1,style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:p.getFieldValue("top_p")||void 0,onChange:function(e){return h(e,"top_p")}})})}),(0,q.jsx)(oe.Z.Item,{name:"seed",rules:[{required:!1}],children:(0,q.jsx)(te.Z.Number,{label:"Seed",min:0,description:c.formatMessage({id:"playground.params.seed.tips"}),style:{width:ae.d.mini}})}),(0,q.jsx)(oe.Z.Item,{name:"stop",rules:[{required:!1}],normalize:function(e){return e||null},children:(0,q.jsx)(te.Z.Input,{allowClear:!0,label:"Stop Sequence",description:c.formatMessage({id:"playground.params.stop.tips"}),style:{width:ae.d.mini}})})]})})},de=(0,S.memo)(ue),pe=t(78093),fe=t(87497),me=function(e){var n=(0,g.useIntl)(),t=e.usage,r=e.showOutput,a=void 0===r||r,s=e.scaleable,o=e.fields,i=void 0===o?["completion_tokens","prompt_tokens"]:o;return!t||Z().isEmpty(t)?null:t.error?(0,q.jsxs)(fe.Z.Paragraph,{type:"danger",ellipsis:{rows:2,tooltip:null==t?void 0:t.errorMessage},style:{textAlign:"center",paddingBlock:0,margin:0,backgroundColor:"var(--ant-color-error-bg)"},children:[(0,q.jsx)(pe.Z,{className:"m-r-8"}),null==t?void 0:t.errorMessage]}):(0,q.jsxs)("div",{className:j()("reference-params",{scaleable:s}),children:[(0,q.jsx)("span",{className:j()("usage",{scaleable:s}),children:(0,q.jsx)(F.Z,{title:(0,q.jsxs)(v.Z,{children:[i.includes("completion_tokens")&&(0,q.jsxs)("span",{children:[n.formatMessage({id:"playground.completion"}),":"," ",t.completion_tokens]}),i.includes("prompt_tokens")&&(0,q.jsxs)("span",{children:[n.formatMessage({id:"playground.prompt"}),":"," ",t.prompt_tokens]})]}),children:(0,q.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenusage"}),":"," ",t.total_tokens]})})}),a&&(0,q.jsx)("span",{className:j()("usage",{scaleable:s}),children:(0,q.jsx)(F.Z,{title:(0,q.jsxs)(v.Z,{children:[(0,q.jsxs)("span",{children:["TPOT: ",Z().round(t.time_per_output_token_ms,2)||0," ms"]}),(0,q.jsxs)("span",{children:["TTFT: ",Z().round(t.time_to_first_token_ms,2)||0," ms"]})]}),children:(0,q.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenoutput"}),":"," ",Z().round(t.tokens_per_second,2)||0," Tokens/s"]})})})]})},he=t(19748),ge=(0,S.forwardRef)((function(e,n){var t=e.modelList,r=(0,S.useRef)(0),s=(0,S.useState)([]),i=l()(s,2),c=i[0],u=i[1],d=(0,g.useIntl)(),p=(0,g.useSearchParams)(),f=l()(p,1)[0].get("model")||"",m=(0,S.useState)({}),h=l()(m,2),v=h[0],x=h[1],y=(0,S.useState)(""),b=l()(y,2),w=b[0],k=b[1],M=(0,S.useState)(!1),C=l()(M,2),R=C[0],z=C[1],L=(0,S.useState)(!1),F=l()(L,2),D=F[0],G=F[1],U=(0,S.useState)(null),V=l()(U,2),W=V[0],B=V[1],K=(0,S.useState)(!1),Y=l()(K,2),J=Y[0],$=Y[1],X=(0,S.useRef)(""),ee=(0,S.useRef)(null),ne=(0,S.useRef)(null),te=(0,S.useRef)(null),re=(0,S.useRef)(null),ae=(0,S.useRef)(0),se=(0,A.Z)(),oe=se.initialize,ie=se.updateScrollerPosition,le=(0,A.Z)().initialize;(0,S.useImperativeHandle)(n,(function(){return{viewCode:function(){z(!0)},setCollapse:function(){$(!J)},collapse:J}}));var ce=(0,S.useMemo)((function(){return(0,I.kA)([{role:I.G7.System,content:w}].concat(_()(c)))}),[c,w]),ue=function(){r.current=r.current+1},pe=function(e){var n;B(T()({},null!==(n=null==e?void 0:e.usage)&&void 0!==n?n:{})),e&&Z().get(e,"choices",[]).length&&(X.current=X.current+Z().get(e,"choices.0.delta.content",""),u([].concat(_()(c),_()(te.current),[{role:I.G7.Assistant,content:X.current,uid:r.current}])))},fe=function(){var e=o()(a()().mark((function e(n){var t,s,o,i,l,d,p,f,m,h,g;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,G(!0),ue(),B(null),null===(t=ee.current)||void 0===t||null===(s=t.abort)||void 0===s||s.call(t),ee.current=new AbortController,o=ee.current.signal,te.current=n?[T()(T()({},n),{},{uid:r.current})]:[],X.current="",u((function(e){return[].concat(_()(e),_()(te.current))})),i=[{role:I.G7.System,content:w}].concat(_()(c),_()(te.current)),l=(0,I.kA)(i),d=T()(T()({messages:l},v),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=17,(0,P.U3)({data:d,url:N.qt,signal:o});case 17:if(null==(p=e.sent)||!p.error){e.next=21;break}return B({error:!0,errorMessage:(null==p||null===(f=p.data)||void 0===f||null===(f=f.error)||void 0===f?void 0:f.message)||(null==p||null===(m=p.data)||void 0===m?void 0:m.message)||""}),e.abrupt("return");case 21:return ue(),h=p.reader,g=p.decoder,e.next=25,(0,P.LN)(h,g,(function(e){var n;null!=e&&e.error?B({error:!0,errorMessage:(null==e||null===(n=e.error)||void 0===n?void 0:n.message)||(null==e?void 0:e.message)||""}):pe(e)}));case 25:e.next=29;break;case 27:e.prev=27,e.t0=e.catch(2);case 29:return e.prev=29,G(!1),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[2,27,29,32]])})));return function(n){return e.apply(this,arguments)}}();return(0,S.useEffect)((function(){ne.current&&oe(ne.current)}),[ne.current,oe]),(0,S.useEffect)((function(){re.current&&le(re.current)}),[re.current,le]),(0,S.useEffect)((function(){D&&ie()}),[c,D]),(0,S.useEffect)((function(){c.length>ae.current&&ie(),ae.current=c.length}),[c.length]),(0,q.jsxs)("div",{className:"ground-left-wrapper",children:[(0,q.jsxs)("div",{className:"ground-left",children:[(0,q.jsx)("div",{className:"message-list-wrap",ref:ne,children:(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{style:{marginBottom:20},children:(0,q.jsx)(Q,{style:{borderRadius:"var(--border-radius-mini)",overflow:"hidden"},systemMessage:w,setSystemMessage:k})}),(0,q.jsxs)("div",{className:"content",children:[(0,q.jsx)(H,{messageList:c,setMessageList:u,editable:!0,loading:D}),D&&(0,q.jsx)(O.Z,{size:"small",children:(0,q.jsx)("div",{style:{height:"46px"}})})]})]})}),W&&(0,q.jsx)("div",{style:{height:40},children:(0,q.jsx)(me,{usage:W})}),(0,q.jsx)("div",{className:"ground-left-footer",children:(0,q.jsx)(E.Z,{defaultSize:{minRows:5,maxRows:5},loading:D,disabled:!v.model,isEmpty:!c.length,handleSubmit:function(e){var n,t=e.content||null!==(n=e.imgs)&&void 0!==n&&n.length?e:void 0;fe(t)},addMessage:function(e){var n,t=e||{role:(null===(n=Z().last(c))||void 0===n?void 0:n.role)===I.G7.User?I.G7.Assistant:I.G7.User,content:""};c.push(T()(T()({},t),{},{uid:r.current+1})),ue(),u(_()(c))},handleAbortFetch:function(){var e,n;null===(e=ee.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),G(!1)},clearAll:function(){c.length&&(ue(),u([]),B(null))},setModelSelections:function(){},presetPrompt:function(e){var n,t=e.filter((function(e){return"system"===e.role})),a=e.filter((function(e){return"user"===e.role})).map((function(e){return ue(),T()(T()({},e),{},{uid:r.current})}));k((null===(n=t[0])||void 0===n?void 0:n.content)||""),u(a)}})})]}),(0,q.jsx)("div",{className:j()("params-wrapper",{collapsed:J}),ref:re,children:(0,q.jsx)("div",{className:"box",children:(0,q.jsx)(de,{setParams:x,params:v,selectedModel:f,modelList:t})})}),(0,q.jsx)(he.Z,T()(T()({},I.NW.chat),{},{open:R,payload:{messages:ce},parameters:v,onCancel:function(){z(!1)},title:d.formatMessage({id:"playground.viewcode"})}))]})})),ve=(0,S.memo)(ge),xe=S.createContext({}),ye=t(23010),be=function(e){var n=e.style,t=(0,g.useIntl)();(0,g.useNavigate)();return(0,q.jsx)("div",{className:"flex-center  justify-center",style:T()({},n),children:(0,q.jsx)(ye.Z,{image:ye.Z.PRESENTED_IMAGE_SIMPLE,description:(0,q.jsx)("div",{className:"flex-column",children:(0,q.jsx)(fe.Z.Text,{type:"secondary",children:t.formatMessage({id:"playground.model.noavailable"})})})})})},we=t(81745),je=t(7922),ke=t(33883),Ze=t(51076),Se=t(69070),Me=t(1404),Ne=t(43211),Ce=t(60857),Te=t(8964),Re=t(40918),_e=(0,S.forwardRef)((function(e,n){var t=e.model,r=e.modelList,s=e.instanceId,i=(0,S.useContext)(xe),u=i.globalParams,d=i.setGlobalParams,p=i.setLoadingStatus,f=i.handleDeleteModel,m=i.handleApplySystemChangeToAll,h=i.modelFullList,v=i.loadingStatus,y=(0,g.useIntl)(),b=(0,S.useRef)(!1),w=(0,S.useState)(""),j=l()(w,2),k=j[0],M=j[1],C=(0,S.useState)({model:t}),R=l()(C,2),E=R[0],z=R[1],L=(0,S.useState)(!1),F=l()(L,2),D=F[0],G=(F[1],(0,S.useRef)(0)),U=(0,S.useState)([]),V=l()(U,2),W=V[0],B=V[1],K=(0,S.useState)(null),J=l()(K,2),$=J[0],X=J[1],ee=(0,S.useState)(!1),ne=l()(ee,2),te=ne[0],re=ne[1],ae=(0,S.useRef)(""),se=(0,S.useRef)(null),oe=(0,S.useRef)([]),ie=(0,S.useRef)(null),le=(0,S.useRef)(0),ce=(0,A.Z)(),ue=ce.initialize,pe=ce.updateScrollerPosition,fe=(0,S.useMemo)((function(){return(0,I.kA)([{role:I.G7.System,content:k}].concat(_()(W)))}),[W,k]),ge=function(){G.current=G.current+1},ve=function(){var e,n;null===(e=se.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),p(s,!1)},ye=function(e){var n;X(T()({},null!==(n=null==e?void 0:e.usage)&&void 0!==n?n:{})),e&&Z().get(e,"choices",[].length)&&(ae.current=ae.current+Z().get(e,"choices.0.delta.content",""),B([].concat(_()(W),_()(oe.current),[{role:I.G7.Assistant,content:ae.current,uid:G.current}])))},be=function(){var e=o()(a()().mark((function e(n){var t,r,o,i,l,c,u,d,f,m,h;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.model){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,p(s,!0),ge(),null===(t=se.current)||void 0===t||null===(r=t.abort)||void 0===r||r.call(t),se.current=new AbortController,o=se.current.signal,oe.current=n?[T()(T()({},n),{},{uid:G.current})]:[],B((function(e){return[].concat(_()(e),_()(oe.current))})),ae.current="",i=[{role:I.G7.System,content:k}].concat(_()(W),_()(oe.current)),l=(0,I.kA)(i),c=T()(T()({messages:l},E),{},{stream:!0,stream_options:{include_usage:!0}}),e.next=16,(0,P.U3)({data:c,url:N.qt,signal:o});case 16:if(null==(u=e.sent)||!u.error){e.next=20;break}return X({error:!0,errorMessage:(null==u||null===(d=u.data)||void 0===d||null===(d=d.error)||void 0===d?void 0:d.message)||(null==u||null===(f=u.data)||void 0===f?void 0:f.message)||""}),e.abrupt("return");case 20:return ge(),m=u.reader,h=u.decoder,e.next=24,(0,P.LN)(m,h,(function(e){var n;null!=e&&e.error?X({error:!0,errorMessage:(null==e||null===(n=e.error)||void 0===n?void 0:n.message)||(null==e?void 0:e.message)||""}):ye(e)}));case 24:e.next=28;break;case 26:e.prev=26,e.t0=e.catch(2);case 28:return e.prev=28,p(s,!1),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[2,26,28,31]])})));return function(n){return e.apply(this,arguments)}}(),we=function(e){var n,t=e.content||null!==(n=e.imgs)&&void 0!==n&&n.length?e:void 0;be(t)},je=(0,S.useCallback)((function(e,n){b.current?(z(T()(T()({},E),n)),d(T()({},n))):z(T()(T()({},E),e))}),[E,b.current]),_e=function(){B([]),X(null),oe.current=[]},Ae=function(e){ge(),B((function(n){return[].concat(_()(n),[T()(T()({},e),{},{uid:G.current})])}))},Pe=function(e){oe.current=[];var n=Z().map(e,(function(e){return ge(),{role:e.role,content:e.content,uid:G.current}}));X(null),B(n)},Oe=((0,S.useMemo)((function(){return h.filter((function(e){return"empty"!==e.type}))}),[h]),(0,S.useMemo)((function(){var e=[{label:y.formatMessage({id:"common.button.clear"}),key:"clear",icon:(0,q.jsx)(Ze.Z,{}),danger:!1,onClick:function(){B([]),M("")}},{label:y.formatMessage({id:"playground.viewcode"}),key:"viewcode",icon:(0,q.jsx)(c.Z,{type:"icon-code"}),onClick:function(){re(!0)}}];return r.length>2&&e.push({label:y.formatMessage({id:"common.button.delete"}),key:"delete",icon:(0,q.jsx)(Se.Z,{}),danger:!0,onClick:function(){f(s)}}),e}),[r,y]));return(0,S.useEffect)((function(){z(T()(T()({},E),u))}),[u]),(0,S.useEffect)((function(){return function(){ve()}}),[]),(0,S.useEffect)((function(){ie.current&&ue(ie.current)}),[ie.current,ue]),(0,S.useEffect)((function(){v[s]&&pe()}),[W]),(0,S.useEffect)((function(){W.length>le.current&&pe(),le.current=W.length}),[W.length]),(0,S.useImperativeHandle)(n,(function(){return{submit:we,abortFetch:ve,addNewMessage:Ae,clear:_e,presetPrompt:Pe,setSystemMessage:M,loading:D}})),(0,q.jsxs)("div",{className:"model-item",children:[(0,q.jsxs)("div",{className:"header",children:[(0,q.jsx)("span",{className:"title",children:(0,q.jsx)(Ce.default,{style:{width:"100%"},variant:"borderless",options:h,onChange:function(e){z(T()(T()({},E),{},{model:e})),_e()},value:E.model,labelRender:function(e){return(0,q.jsx)(ke.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})},optionRender:function(e){return(0,q.jsx)(ke.Z,{ghost:!0,tooltipProps:{placement:"right"},minWidth:60,maxWidth:180,children:e.label})}})}),(0,q.jsx)(me,{usage:$,scaleable:!0}),(0,q.jsxs)("span",{className:"action",children:[(0,q.jsx)(Te.Z,{menu:{items:Oe},placement:"bottomRight",children:(0,q.jsx)(x.ZP,{type:"text",icon:(0,q.jsx)(Me.Z,{style:{fontSize:"14px"}}),size:"small"})}),(0,q.jsx)(Re.Z,{placement:"bottomRight",content:(0,q.jsx)(de,{showModelSelector:!1,setParams:z,modelList:r,globalParams:u,selectedModel:E.model,onValuesChange:je}),trigger:["click"],arrow:!1,fresh:!0,title:(0,q.jsx)("div",{children:(0,q.jsx)(Y.Z,{onChange:function(e){b.current=e.target.checked,e.target.checked&&d(T()({},Z().omit(E,"model")))},children:y.formatMessage({id:"playground.compare.applytoall"})})}),children:(0,q.jsx)(x.ZP,{type:"text",icon:(0,q.jsx)(Ne.Z,{}),size:"small"})})]})]}),(0,q.jsx)(Q,{showApplyToAll:!0,systemMessage:k,applyToAll:m,setSystemMessage:M}),(0,q.jsx)("div",{className:"content",ref:ie,children:(0,q.jsxs)("div",{children:[(0,q.jsx)(H,{messageList:W,setMessageList:B,editable:!0}),(0,q.jsx)(O.Z,{spinning:!!v[s],size:"small",style:{width:"100%"}})]})}),(0,q.jsx)(he.Z,T()(T()({},I.NW.chat),{},{open:te,payload:{messages:fe},parameters:E,onCancel:function(){re(!1)},title:y.formatMessage({id:"playground.viewcode"})}))]})})),Ae=S.memo(_e),Pe=function(e){var n=e.spans,t=e.modelSelections,r=e.setModelRefs;return(0,q.jsx)(we.Z,{gutter:[16,0],style:{height:"100%"},children:t.map((function(e,a){return(0,q.jsx)(je.Z,{span:n.span,style:{height:n.count<4?"calc(100% - 16px)":"calc(50% - 16px)"},children:(0,q.jsx)(Ae,{ref:function(n){return r(e.instanceId,n)},instanceId:e.instanceId,modelList:t,model:e.value},"".concat(e.value||"empty","-").concat(e.uid))},"".concat(e.value||"empty","-").concat(e.uid))}))})},Oe=S.memo(Pe),Ie=function(e){var n=e.modelList,t=e.loaded,r=(0,A.Z)().initialize,s=(0,S.useState)({}),i=l()(s,2),c=i[0],u=i[1],d=(0,S.useState)([]),p=l()(d,2),f=p[0],m=p[1],h=(0,S.useState)({seed:null,stop:null,temperature:1,top_p:1,max_tokens:1024}),g=l()(h,2),v=g[0],x=g[1],y=(0,S.useState)({span:12,count:2}),b=l()(y,2),w=b[0],j=b[1],k=(0,S.useRef)({}),M=(0,S.useRef)({}),N=(0,S.useRef)(null),C=(0,S.useMemo)((function(){return Object.getOwnPropertySymbols(c).some((function(e){return c[e]}))}),[c]),R=((0,S.useMemo)((function(){return n.map((function(e){return T()(T()({},e),{},{disabled:f.some((function(n){return n.value===e.value}))})}))}),[n,f]),function(e){return k.current[e]=Z().add(k.current[e],1),k.current[e]}),_=(0,S.useCallback)((function(e,n){M.current[e]=n}),[]);return(0,S.useEffect)((function(){M.current={};var e=Z().take(n,w.count);if(e.length<w.count&&e.length>0){var t=w.count-e.length,r=Array.from({length:t},(function(e,n){return{label:"",value:"",type:"empty"}}));e=Z().concat(e,r)}var a=e.map((function(e){return T()(T()({},e),{},{uid:R(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));m(a)}),[n]),(0,S.useEffect)((function(){N.current&&r(N.current)}),[N.current,r]),(0,q.jsxs)("div",{className:"multiple-chat",style:{height:"calc(100vh - 72px)"},children:[(0,q.jsx)("div",{className:"chat-list",ref:N,children:n.length>0?(0,q.jsx)(xe.Provider,{value:{spans:w,globalParams:v,loadingStatus:c,modelFullList:n,handleApplySystemChangeToAll:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(n){var t=M.current[n];null==t||t.setSystemMessage(e)}))},setGlobalParams:x,setLoadingStatus:function(e,n){u((function(t){var r=T()({},t);return r[e]=n,r}))},handleDeleteModel:function(e){var n,t=f.filter((function(n){return n.instanceId!==e}));!function(e){M.current[e]=null,c[e]=!1}(e),n=w.count-1,6===w.count?j({span:8,count:n}):5===w.count?j({span:12,count:n}):4===w.count?j({span:8,count:n}):3===w.count&&j({span:12,count:n}),m(t)}},children:(0,q.jsx)(Oe,{spans:w,modelSelections:f,setModelRefs:_})}):t&&(0,q.jsx)(be,{style:{height:"100%",paddingBottom:60}})}),(0,q.jsx)("div",{children:(0,q.jsx)(E.Z,{loading:C,disabled:C||!f.length||!n.length,handleSubmit:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(n){var t=M.current[n];null==t||t.submit(e)}))},addMessage:function(e){Object.getOwnPropertySymbols(M.current).forEach((function(n){var t=M.current[n];null==t||t.addNewMessage(e)}))},handleAbortFetch:function(){Object.getOwnPropertySymbols(M.current).forEach((function(e){var n=M.current[e];null==n||n.abortFetch()}))},clearAll:function(){Object.getOwnPropertySymbols(M.current).forEach((function(e){var n=M.current[e];null==n||n.clear()}))},updateLayout:function(e){j(e),function(e){var t=f;if(t.length<e.count){var r=e.count-t.length,a=Z().slice(n,t.length,t.length+r),s=Array.from({length:r-a.length},(function(e,n){return{label:"",value:"",type:"empty"}})),o=Z().concat(a,s).map((function(e){return T()(T()({},e),{},{uid:R(e.value||"empty"),instanceId:"empty"===e.type?Symbol("empty"):Symbol(e.value)})}));m(Z().concat(t,o))}else if(t.length>e.count){var i=t.slice(0,e.count);m(i)}}(e)},setModelSelections:function(e){var n=e.map((function(e){return T()(T()({},e),{},{uid:R(e.value),instanceId:Symbol(e.value)})})),t=Z().concat(f,n),r=Math.floor(24/t.length);j({span:r<8?8:r,count:w.count}),m(t)},presetPrompt:function(e){var n=e.filter((function(e){return"system"===e.role})),t=e.filter((function(e){return"user"===e.role}));Object.getOwnPropertySymbols(M.current).forEach(function(){var e=o()(a()().mark((function e(r){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(s=M.current[r])||s.presetPrompt(t),null==s||s.setSystemMessage(Z().get(n,"0.content",""));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},defaultSize:{minRows:5,maxRows:5}})})]})},Ee=(0,S.memo)(Ie),ze=(t(20988),function(){var e=(0,g.useIntl)(),n=(0,p.Z)().size,t=(0,S.useState)("chat"),r=l()(t,2),s=r[0],i=r[1],w=(0,S.useRef)(null),k=(0,S.useRef)(null),C=(0,S.useState)([]),T=l()(C,2),R=T[0],_=T[1],A=(0,S.useState)(!1),P=l()(A,2),O=P[0],I=P[1],E=[{label:e.formatMessage({id:"menu.playground.chat"}),value:"chat",icon:(0,q.jsx)(f.Z,{})},{label:e.formatMessage({id:"menu.compare"}),value:"compare",icon:(0,q.jsx)(m.Z,{})}],z=(0,S.useCallback)((function(){var e,n;if("reranker"===s)null===(e=k.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e);else if("chat"===s){var t,r;null===(t=w.current)||void 0===t||null===(r=t.viewCode)||void 0===r||r.call(t)}}),[w,k,s]),L=(0,S.useCallback)((function(){var e,n,t,r;"reranker"!==s?null===(e=w.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e):null===(t=k.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t)}),[w,k,s]),F=[{key:"chat",label:"Chat",children:(0,q.jsx)(ve,{ref:w,modelList:R})},{key:"compare",label:"Compare",children:(0,q.jsx)(Ee,{modelList:R,loaded:O})}];(0,S.useEffect)((function(){var e,t,r;n.width<u.Z.lg&&(null!==(e=w.current)&&void 0!==e&&e.collapse||null===(t=w.current)||void 0===t||null===(r=t.setCollapse)||void 0===r||r.call(t))}),[n.width]),(0,S.useEffect)((function(){var e=function(){var e=o()(a()().mark((function e(){var n,t,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={embedding_only:!1,image_only:!1,reranker:!1,text_to_speech:!1,speech_to_text:!1},e.next=4,(0,N.nb)(n);case 4:return t=e.sent,r=Z().map(t.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var n=o()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:t=n.sent,_(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),I(!0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();n()}),[]);return(0,M.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=w.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,q.jsx)(h._z,{ghost:!0,header:{title:(0,q.jsxs)("div",{className:"flex items-center",children:[(0,q.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.chat"})}),(0,q.jsx)(y.Z,{options:E,size:"middle",className:"m-l-40",onChange:function(e){return i(e)}})]}),breadcrumb:{}},extra:"compare"!==s&&(0,q.jsxs)(v.Z,{children:[(0,q.jsx)(x.ZP,{size:"middle",onClick:z,icon:(0,q.jsx)(c.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,q.jsx)(x.ZP,{size:"middle",onClick:L,icon:(0,q.jsx)(c.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:j()("playground-container",{compare:"compare"===s,chat:"compare"!==s}),children:(0,q.jsx)("div",{className:"play-ground",children:(0,q.jsx)("div",{className:"chat",children:(0,q.jsx)(b.Z,{items:F,activeKey:s})})})})})},81117:function(e,n,t){t.d(n,{LN:function(){return h},U3:function(){return m},YT:function(){return v}});var r=t(335),a=t.n(r),s=t(90228),o=t.n(s),i=t(26068),l=t.n(i),c=t(87999),u=t.n(c),d=t(55360),p=/data:\s*({.*?})(?=\n|$)/g,f=function(e){var n,t=[];if(!e)return t;for(;null!==(n=p.exec(e));)try{var r=JSON.parse(n[1]);t.push(r)}catch(e){continue}return t},m=function(){var e=u()(o()().mark((function e(n){var t,r,a,s,i,c;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.method||"POST",a=n.url,n.params&&(a="".concat(a,"?").concat(d.Z.stringify(n.params))),e.next=5,fetch(a,{method:r,body:"POST"===r?JSON.stringify(n.data):null,signal:n.signal,headers:l()({"Content-Type":"application/json"},n.headers)});case 5:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.json();case 10:return e.t0=e.sent,e.abrupt("return",{error:!0,data:e.t0});case 12:return i=null==s||null===(t=s.body)||void 0===t?void 0:t.getReader(),c=new TextDecoder("utf-8",{fatal:!0}),e.abrupt("return",{reader:i,decoder:c});case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),h=function(){var e=u()(o()().mark((function e(n,t,r){var a,s,i,l;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.read();case 2:if(a=e.sent,s=a.done,i=a.value,!s){e.next=7;break}return e.abrupt("return");case 7:return l=t.decode(i,{stream:!0}),f(l).forEach((function(e){null==r||r(e)})),e.next=11,h(n,t,r);case 11:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),g=function(e,n){var t,r=e.split("\n"),s=a()(r);try{for(s.s();!(t=s.n()).done;){var o=t.value;if(o.startsWith("data: ")){var i=o.slice(6).trim();try{n(JSON.parse(i))}catch(e){}}}}catch(e){s.e(e)}finally{s.f()}},v=function(){var e=u()(o()().mark((function e(n,t,r){var s,i,l,c,u,d,p,f,m,h,v;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s="";case 1:return e.next=4,null==n||null===(i=n.read)||void 0===i?void 0:i.call(n);case 4:if(l=e.sent,c=l.done,u=l.value,!c){e.next=10;break}return s.trim()&&g(s,r),e.abrupt("break",17);case 10:s+=t.decode(u,{stream:!0}),d=s.split("\n"),s=d.pop()||"",p=a()(d);try{for(p.s();!(f=p.n()).done;)if((m=f.value).startsWith("data: ")){h=m.slice(6).trim();try{"[DONE]"!==h&&(v=JSON.parse(h),r(v))}catch(e){}}}catch(e){p.e(e)}finally{p.f()}e.next=1;break;case 17:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}()},26938:function(e,n){n.Z={label:"label___Im6e1"}},51662:function(){},20988:function(){}}]);