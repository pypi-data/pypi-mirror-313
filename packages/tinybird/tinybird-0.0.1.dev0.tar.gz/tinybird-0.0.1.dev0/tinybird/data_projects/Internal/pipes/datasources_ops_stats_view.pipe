NODE datasources_ops_stats_view_0
SQL >

    SELECT
      toDate(timestamp) as event_date,
      user_id as workspace_id,
      event_type,
      pipe_id,
      anyLast(pipe_name) as pipe_name,
      countIf(error != null) as error_count,
      count() as executions,
      avgState(elapsed_time) avg_elapsed_time_state,
      quantilesState(0.9, 0.95, 0.99) (elapsed_time) quantiles_state,
      sum(read_bytes) as read_bytes,
      sum(read_rows) as read_rows,
      sum(written_bytes) as written_bytes,
      sum(written_rows) as written_rows,
      sum(written_bytes_quarantine) as written_bytes_quarantine,
      sum(written_rows_quarantine) as written_rows_quarantine,
      groupUniqArrayArray(resource_tags) AS resource_tags
    FROM datasources_ops_log
    GROUP BY
            event_date,
            workspace_id,
            event_type,
            pipe_id

TYPE MATERIALIZED
DATASOURCE datasources_ops_stats
